/*! dude2019 12-02-2020 14:34 - Digitoimisto Dude Oy (moro@dude.fi) */
/(trident|msie)/i.test(navigator.userAgent)&&document.getElementById&&window.addEventListener&&window.addEventListener("hashchange",function(){var t,e=location.hash.substring(1);/^[A-z0-9_-]+$/.test(e)&&(t=document.getElementById(e))&&(/^(?:a|select|input|button|textarea)$/i.test(t.tagName)||(t.tabIndex=-1),t.focus())},!1);var MoveTo=function(){var t={tolerance:0,duration:800,easing:"easeOutQuart",container:window,callback:function(){}};function e(t,e,i,s){return t/=s,-i*(--t*t*t*t-1)+e}function i(t,e){var i={};return Object.keys(t).forEach(function(e){i[e]=t[e]}),Object.keys(e).forEach(function(t){i[t]=e[t]}),i}function s(t){return t instanceof HTMLElement?t.scrollTop:t.pageYOffset}function n(){var s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.options=i(t,s),this.easeFunctions=i({easeOutQuart:e},n)}return n.prototype.registerTrigger=function(t,e){var s=this;if(t){var n=t.getAttribute("href")||t.getAttribute("data-target"),o=n&&"#"!==n?document.getElementById(n.substring(1)):document.body,a=i(this.options,function(t,e){var i={};return Object.keys(e).forEach(function(e){var s=t.getAttribute("data-mt-".concat(e.replace(/([A-Z])/g,function(t){return"-"+t.toLowerCase()})));s&&(i[e]=isNaN(s)?s:parseInt(s,10))}),i}(t,this.options));"function"==typeof e&&(a.callback=e);var r=function(t){t.preventDefault(),s.move(o,a)};return t.addEventListener("click",r,!1),function(){return t.removeEventListener("click",r,!1)}}},n.prototype.move=function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(0===t||t){n=i(this.options,n);var o,a="number"==typeof t?t:t.getBoundingClientRect().top,r=s(n.container),l=null;a-=n.tolerance;window.requestAnimationFrame(function i(h){var c=s(e.options.container);l||(l=h-1);var d=h-l;if(o&&(a>0&&o>c||a<0&&o<c))return n.callback(t);o=c;var u=e.easeFunctions[n.easing](d,r,a,n.duration);n.container.scroll(0,u),d<n.duration?window.requestAnimationFrame(i):(n.container.scroll(0,a+r),n.callback(t))})}},n.prototype.addEaseFunction=function(t,e){this.easeFunctions[t]=e},n}();"undefined"!=typeof module?module.exports=MoveTo:window.MoveTo=MoveTo,function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("whatInput",[],e):"object"==typeof exports?exports.whatInput=e():t.whatInput=e()}(this,function(){return function(t){var e={};function i(s){if(e[s])return e[s].exports;var n=e[s]={exports:{},id:s,loaded:!1};return t[s].call(n.exports,n,n.exports,i),n.loaded=!0,n.exports}return i.m=t,i.c=e,i.p="",i(0)}([function(t,e){"use strict";t.exports=function(){if("undefined"==typeof document||"undefined"==typeof window)return{ask:function(){return"initial"},element:function(){return null},ignoreKeys:function(){},specificKeys:function(){},registerOnChange:function(){},unRegisterOnChange:function(){}};var t=document.documentElement,e=null,i="initial",s=i,n=Date.now();try{window.sessionStorage.getItem("what-input")&&(i=window.sessionStorage.getItem("what-input")),window.sessionStorage.getItem("what-intent")&&(s=window.sessionStorage.getItem("what-intent"))}catch(t){}var o=["button","input","select","textarea"],a=[],r=[16,17,18,91,93],l=[],h={keydown:"keyboard",keyup:"keyboard",mousedown:"mouse",mousemove:"mouse",MSPointerDown:"pointer",MSPointerMove:"pointer",pointerdown:"pointer",pointermove:"pointer",touchstart:"touch",touchend:"touch"},c=!1,d={x:null,y:null},u={2:"touch",3:"touch",4:"mouse"},p=!1;try{var m=Object.defineProperty({},"passive",{get:function(){p=!0}});window.addEventListener("test",null,m)}catch(t){}var f=function(){var t=!!p&&{passive:!0};window.PointerEvent?(window.addEventListener("pointerdown",g),window.addEventListener("pointermove",v)):window.MSPointerEvent?(window.addEventListener("MSPointerDown",g),window.addEventListener("MSPointerMove",v)):(window.addEventListener("mousedown",g),window.addEventListener("mousemove",v),"ontouchstart"in window&&(window.addEventListener("touchstart",g,t),window.addEventListener("touchend",g))),window.addEventListener(S(),v,t),window.addEventListener("keydown",g),window.addEventListener("keyup",g),window.addEventListener("focusin",w),window.addEventListener("focusout",b)},g=function(t){var e=t.which,n=h[t.type];"pointer"===n&&(n=x(t));var a=!l.length&&-1===r.indexOf(e),c=l.length&&-1!==l.indexOf(e),d="keyboard"===n&&e&&(a||c)||"mouse"===n||"touch"===n;if(C(n)&&(d=!1),d&&i!==n){i=n;try{window.sessionStorage.setItem("what-input",i)}catch(t){}y("input")}if(d&&s!==n){var u=document.activeElement;if(u&&u.nodeName&&-1===o.indexOf(u.nodeName.toLowerCase())||"button"===u.nodeName.toLowerCase()&&!k(u,"form")){s=n;try{window.sessionStorage.setItem("what-intent",s)}catch(t){}y("intent")}}},y=function(e){t.setAttribute("data-what"+e,"input"===e?i:s),E(e)},v=function(t){var e=h[t.type];if("pointer"===e&&(e=x(t)),I(t),!c&&!C(e)&&s!==e){s=e;try{window.sessionStorage.setItem("what-intent",s)}catch(t){}y("intent")}},w=function(i){i.target.nodeName?(e=i.target.nodeName.toLowerCase(),t.setAttribute("data-whatelement",e),i.target.classList&&i.target.classList.length&&t.setAttribute("data-whatclasses",i.target.classList.toString().replace(" ",","))):b()},b=function(){e=null,t.removeAttribute("data-whatelement"),t.removeAttribute("data-whatclasses")},x=function(t){return"number"==typeof t.pointerType?u[t.pointerType]:"pen"===t.pointerType?"touch":t.pointerType},C=function(t){var e=Date.now(),s="mouse"===t&&"touch"===i&&e-n<200;return n=e,s},S=function(){return"onwheel"in document.createElement("div")?"wheel":void 0!==document.onmousewheel?"mousewheel":"DOMMouseScroll"},E=function(t){for(var e=0,n=a.length;e<n;e++)a[e].type===t&&a[e].fn.call(void 0,"input"===t?i:s)},I=function(t){d.x!==t.screenX||d.y!==t.screenY?(c=!1,d.x=t.screenX,d.y=t.screenY):c=!0},k=function(t,e){var i=window.Element.prototype;if(i.matches||(i.matches=i.msMatchesSelector||i.webkitMatchesSelector),i.closest)return t.closest(e);do{if(t.matches(e))return t;t=t.parentElement||t.parentNode}while(null!==t&&1===t.nodeType);return null};return"addEventListener"in window&&Array.prototype.indexOf&&(h[S()]="mouse",f(),y("input"),y("intent")),{ask:function(t){return"intent"===t?s:i},element:function(){return e},ignoreKeys:function(t){r=t},specificKeys:function(t){l=t},registerOnChange:function(t,e){a.push({fn:t,type:e||"input"})},unRegisterOnChange:function(t){var e=function(t){for(var e=0,i=a.length;e<i;e++)if(a[e].fn===t)return e}(t);(e||0===e)&&a.splice(e,1)}}}()}])}),function(){var t,e;t=this,e=function(){var t={startStopTimes:{},idleTimeoutMs:3e4,currentIdleTimeMs:0,checkStateRateMs:250,active:!1,idle:!1,currentPageName:"default-page-name",timeElapsedCallbacks:[],userLeftCallbacks:[],userReturnCallbacks:[],trackTimeOnElement:function(e){var i=document.getElementById(e);i&&(i.addEventListener("mouseover",function(){t.startTimer(e)}),i.addEventListener("mousemove",function(){t.startTimer(e)}),i.addEventListener("mouseleave",function(){t.stopTimer(e)}),i.addEventListener("keypress",function(){t.startTimer(e)}),i.addEventListener("focus",function(){t.startTimer(e)}))},getTimeOnElementInSeconds:function(e){var i=t.getTimeOnPageInSeconds(e);return i||0},startTimer:function(e){if(e||(e=t.currentPageName),void 0===t.startStopTimes[e])t.startStopTimes[e]=[];else{var i=t.startStopTimes[e],s=i[i.length-1];if(void 0!==s&&void 0===s.stopTime)return}t.startStopTimes[e].push({startTime:new Date,stopTime:void 0}),t.active=!0},stopAllTimers:function(){for(var e=Object.keys(t.startStopTimes),i=0;i<e.length;i++)t.stopTimer(e[i])},stopTimer:function(e){e||(e=t.currentPageName);var i=t.startStopTimes[e];void 0!==i&&0!==i.length&&(void 0===i[i.length-1].stopTime&&(i[i.length-1].stopTime=new Date),t.active=!1)},getTimeOnCurrentPageInSeconds:function(){return t.getTimeOnPageInSeconds(t.currentPageName)},getTimeOnPageInSeconds:function(e){return void 0===t.getTimeOnPageInMilliseconds(e)?void 0:t.getTimeOnPageInMilliseconds(e)/1e3},getTimeOnCurrentPageInMilliseconds:function(){return t.getTimeOnPageInMilliseconds(t.currentPageName)},getTimeOnPageInMilliseconds:function(e){var i=t.startStopTimes[e];if(void 0!==i){for(var s=0,n=0;n<i.length;n++){var o=i[n].startTime,a=i[n].stopTime;void 0===a&&(a=new Date),s+=a-o}return Number(s)}},getTimeOnAllPagesInSeconds:function(){for(var e=[],i=Object.keys(t.startStopTimes),s=0;s<i.length;s++){var n=i[s],o=t.getTimeOnPageInSeconds(n);e.push({pageName:n,timeOnPage:o})}return e},setIdleDurationInSeconds:function(e){var i=parseFloat(e);if(!1!==isNaN(i))throw{name:"InvalidDurationException",message:"An invalid duration time ("+e+") was provided."};return t.idleTimeoutMs=1e3*e,this},setCurrentPageName:function(e){return t.currentPageName=e,this},resetRecordedPageTime:function(e){delete t.startStopTimes[e]},resetAllRecordedPageTimes:function(){for(var e=Object.keys(t.startStopTimes),i=0;i<e.length;i++)t.resetRecordedPageTime(e[i])},resetIdleCountdown:function(){t.idle&&t.triggerUserHasReturned(),t.idle=!1,t.currentIdleTimeMs=0},callWhenUserLeaves:function(t,e){this.userLeftCallbacks.push({callback:t,numberOfTimesToInvoke:e})},callWhenUserReturns:function(t,e){this.userReturnCallbacks.push({callback:t,numberOfTimesToInvoke:e})},triggerUserHasReturned:function(){if(!t.active)for(var e=0;e<this.userReturnCallbacks.length;e++){var i=this.userReturnCallbacks[e],s=i.numberOfTimesToInvoke;(isNaN(s)||void 0===s||s>0)&&(i.numberOfTimesToInvoke-=1,i.callback())}t.startTimer()},triggerUserHasLeftPage:function(){if(t.active)for(var e=0;e<this.userLeftCallbacks.length;e++){var i=this.userLeftCallbacks[e],s=i.numberOfTimesToInvoke;(isNaN(s)||void 0===s||s>0)&&(i.numberOfTimesToInvoke-=1,i.callback())}t.stopAllTimers()},callAfterTimeElapsedInSeconds:function(e,i){t.timeElapsedCallbacks.push({timeInSeconds:e,callback:i,pending:!0})},checkState:function(){for(var e=0;e<t.timeElapsedCallbacks.length;e++)t.timeElapsedCallbacks[e].pending&&t.getTimeOnCurrentPageInSeconds()>t.timeElapsedCallbacks[e].timeInSeconds&&(t.timeElapsedCallbacks[e].callback(),t.timeElapsedCallbacks[e].pending=!1);!1===t.idle&&t.currentIdleTimeMs>t.idleTimeoutMs?(t.idle=!0,t.triggerUserHasLeftPage()):t.currentIdleTimeMs+=t.checkStateRateMs},visibilityChangeEventName:void 0,hiddenPropName:void 0,listenForVisibilityEvents:function(){void 0!==document.hidden?(t.hiddenPropName="hidden",t.visibilityChangeEventName="visibilitychange"):void 0!==document.mozHidden?(t.hiddenPropName="mozHidden",t.visibilityChangeEventName="mozvisibilitychange"):void 0!==document.msHidden?(t.hiddenPropName="msHidden",t.visibilityChangeEventName="msvisibilitychange"):void 0!==document.webkitHidden&&(t.hiddenPropName="webkitHidden",t.visibilityChangeEventName="webkitvisibilitychange"),document.addEventListener(t.visibilityChangeEventName,function(){document[t.hiddenPropName]?t.triggerUserHasLeftPage():t.triggerUserHasReturned()},!1),window.addEventListener("blur",function(){t.triggerUserHasLeftPage()}),window.addEventListener("focus",function(){t.triggerUserHasReturned()}),document.addEventListener("mousemove",function(){t.resetIdleCountdown()}),document.addEventListener("keyup",function(){t.resetIdleCountdown()}),document.addEventListener("touchstart",function(){t.resetIdleCountdown()}),window.addEventListener("scroll",function(){t.resetIdleCountdown()}),setInterval(function(){t.checkState()},t.checkStateRateMs)},websocket:void 0,websocketHost:void 0,setUpWebsocket:function(e){if(window.WebSocket&&e){var i=e.websocketHost;try{t.websocket=new WebSocket(i),window.onbeforeunload=function(i){t.sendCurrentTime(e.appId)},t.websocket.onopen=function(){t.sendInitWsRequest(e.appId)},t.websocket.onerror=function(t){console&&console.log("Error occurred in websocket connection: "+t)},t.websocket.onmessage=function(t){console&&console.log(t.data)}}catch(t){console&&console.error("Failed to connect to websocket host.  Error:"+t)}}return this},websocketSend:function(e){t.websocket.send(JSON.stringify(e))},sendCurrentTime:function(e){var i={type:"INSERT_TIME",appId:e,timeOnPageMs:t.getTimeOnCurrentPageInMilliseconds(),pageName:t.currentPageName};t.websocketSend(i)},sendInitWsRequest:function(e){var i={type:"INIT",appId:e};t.websocketSend(i)},initialize:function(e){var i=t.idleTimeoutMs||30,s=t.currentPageName||"default-page-name",n=void 0;e&&(i=e.idleTimeoutInSeconds||i,s=e.currentPageName||s,n=e.websocketOptions),t.setIdleDurationInSeconds(i).setCurrentPageName(s).setUpWebsocket(n).listenForVisibilityEvents(),t.startTimer()}};return t},"undefined"!=typeof module&&module.exports?module.exports=e():"function"==typeof define&&define.amd?define([],function(){return t.TimeMe=e()}):t.TimeMe=e()}.call(this),function(t){var e,i,s,n,o,a,r,l,h,c,d,u,p=t(".nav-container"),m=p.find(".nav-toggle"),f=p.find("#main-navigation-wrapper"),g=p.find("#nav"),y=document.querySelector(".nav-primary"),v=document.querySelector(".block-hero-enable-transition"),w=t("<button />",{class:"dropdown-toggle","aria-expanded":!1}).append(t("<span />",{class:"screen-reader-text",text:dude_screenReaderText.expand}));if(t(".block-hero-enable-transition").length&&v.addEventListener("transitionend",function(){v.classList.remove("is-animatable")},!1),t(".nav-primary").length&&y.addEventListener("transitionend",function(){y.classList.remove("is-animatable")},!1),m.length&&(m.add(g).attr("aria-expanded","false"),m.on("click",function(){t("body").toggleClass("js-nav-active"),t(".block-hero-enable-transition").toggleClass("add-blur"),"Lisää"==t(this).find(".toggle-text").text()?t(this).find(".toggle-text").text("Sulje"):t(this).find(".toggle-text").text("Lisää"),t(".nav-primary").addClass("is-animatable"),t(".block-hero-enable-transition").addClass("is-animatable"),t(this).add(g).attr("aria-expanded","false"===t(this).add(g).attr("aria-expanded")?"true":"false")})),t(".menu-item-has-children > a").after(w),f.find(".menu-item-has-children").attr("aria-haspopup","true"),f.find(".dropdown-toggle").click(function(e){screenReaderSpan=t(this).find(".screen-reader-text"),dropdownMenu=t(this).nextAll(".sub-menu"),e.preventDefault(),t(this).toggleClass("toggled-on"),dropdownMenu.toggleClass("toggled-on"),t(this).attr("aria-expanded","false"===t(this).attr("aria-expanded")?"true":"false"),screenReaderSpan.text(screenReaderSpan.text()===dude_screenReaderText.expand?dude_screenReaderText.collapse:dude_screenReaderText.expand)}),t(".sub-menu .menu-item-has-children").parent(".sub-menu").addClass("has-sub-menu"),t(".menu-item a, button.dropdown-toggle").on("keydown",function(e){if(-1!=[37,38,39,40].indexOf(e.keyCode))switch(e.keyCode){case 37:e.preventDefault(),e.stopPropagation(),t(this).hasClass("dropdown-toggle")?t(this).prev("a").focus():t(this).parent().prev().children("button.dropdown-toggle").length?t(this).parent().prev().children("button.dropdown-toggle").focus():t(this).parent().prev().children("a").focus(),t(this).is("ul ul ul.sub-menu.toggled-on li:first-child a")&&t(this).parents("ul.sub-menu.toggled-on li").children("button.dropdown-toggle").focus();break;case 39:e.preventDefault(),e.stopPropagation(),t(this).next("button.dropdown-toggle").length?t(this).next("button.dropdown-toggle").focus():t(this).parent().next().children("a").focus(),t(this).is("ul.sub-menu .dropdown-toggle.toggled-on")&&t(this).parent().find("ul.sub-menu li:first-child a").focus();break;case 40:e.preventDefault(),e.stopPropagation(),t(this).next().length?t(this).next().find("li:first-child a").first().focus():t(this).parent().next().children("a").focus(),t(this).is("ul.sub-menu a")&&t(this).next("button.dropdown-toggle").length&&t(this).parent().next().children("a").focus(),t(this).is("ul.sub-menu .dropdown-toggle")&&t(this).parent().next().children(".dropdown-toggle").length&&t(this).parent().next().children(".dropdown-toggle").focus();break;case 38:e.preventDefault(),e.stopPropagation(),t(this).parent().prev().length?t(this).parent().prev().children("a").focus():t(this).parents("ul").first().prev(".dropdown-toggle.toggled-on").focus(),t(this).is("ul.sub-menu .dropdown-toggle")&&t(this).parent().prev().children(".dropdown-toggle").length&&t(this).parent().prev().children(".dropdown-toggle").focus()}}),(s=document.getElementById("nav"))&&(container_desktop=document.getElementById("nav-desktop"),container_desktop&&void 0!==(n=document.getElementById("nav-toggle"))&&(button_desktop=document.getElementById("nav-toggle-desktop"),"undefined"!=typeof button_desktop)))if(e=document.getElementsByTagName("html")[0],i=document.getElementsByTagName("body")[0],o=s.getElementsByTagName("ul")[0],a=document.getElementById("main-navigation-wrapper"),void 0!==o)for(o.setAttribute("aria-expanded","false"),-1===o.className.indexOf("nav-menu")&&(o.className+=" nav-menu"),n.onclick=function(){-1!==s.className.indexOf("is-active")?b():(e.className+=" disable-scroll",i.className+=" js-nav-active",s.className+=" is-active",n.className+=" is-active",n.setAttribute("aria-expanded","true"),o.setAttribute("aria-expanded","true"),c=s.querySelectorAll(["a[href]","area[href]","input:not([disabled])","select:not([disabled])","textarea:not([disabled])","button:not([disabled])","iframe","object","embed","[contenteditable]",'[tabindex]:not([tabindex^="-"])']),d=c[0],(u=c[c.length-1]).addEventListener("keydown",function(t){9!==t.keyCode||t.shiftKey||(t.preventDefault(),n.focus())}),d.addEventListener("keydown",function(t){9===t.keyCode&&t.shiftKey&&(t.preventDefault(),n.focus())}),n.addEventListener("keydown",function(t){9===t.keyCode&&t.shiftKey&&(t.preventDefault(),u.focus())}))},document.addEventListener("keyup",function(e){27==e.keyCode&&("Lisää"==t(this).find(".toggle-text").text()?t(this).find(".toggle-text").text("Sulje"):t(this).find(".toggle-text").text("Lisää"),t("body").removeClass("js-nav-active"),-1!==s.className.indexOf("is-active")&&b())}),a.onclick=function(t){t.target==a&&-1!==s.className.indexOf("is-active")&&b()},button_desktop.onclick=function(){document.body.classList.contains("js-nav-active")?(e.className=e.className.replace(" disable-scroll",""),n.className=n.className.replace(" is-active",""),n.setAttribute("aria-expanded","false"),o.setAttribute("aria-expanded","false"),n.focus()):(e.className+=" disable-scroll",button_desktop.setAttribute("aria-expanded","true"),o.setAttribute("aria-expanded","true"),focusableElements_desktop=s.querySelectorAll(["a[href]","area[href]","input:not([disabled])","select:not([disabled])","textarea:not([disabled])","button_desktop:not([disabled])","iframe","object","embed","[contenteditable]",'[tabindex]:not([tabindex^="-"])',"button"]),firstFocusableElement_desktop=focusableElements_desktop[0],lastFocusableElement_desktop=focusableElements_desktop[focusableElements_desktop.length-1],button_desktop.addEventListener("keydown",function(t){9!==t.keyCode||t.shiftKey||document.body.classList.contains("js-nav-active")&&(t.preventDefault(),firstFocusableElement_desktop.focus())}),lastFocusableElement_desktop.addEventListener("keydown",function(t){9!==t.keyCode||t.shiftKey||document.body.classList.contains("js-nav-active")&&(t.preventDefault(),button_desktop.focus())}),firstFocusableElement_desktop.addEventListener("keydown",function(t){9===t.keyCode&&t.shiftKey&&document.body.classList.contains("js-nav-active")&&(t.preventDefault(),button_desktop.focus())}),button_desktop.addEventListener("keydown",function(t){9===t.keyCode&&t.shiftKey&&document.body.classList.contains("js-nav-active")&&(t.preventDefault(),lastFocusableElement_desktop.focus())}))},r=o.getElementsByTagName("a"),o.getElementsByTagName("ul"),l=0,h=r.length;l<h;l++)r[l].addEventListener("focus",x,!0),r[l].addEventListener("blur",x,!0);else n.style.display="none";function b(){e.className=e.className.replace(" disable-scroll",""),i.className=i.className.replace(" js-nav-active",""),s.className=s.className.replace(" is-active",""),n.className=n.className.replace(" is-active",""),n.setAttribute("aria-expanded","false"),o.setAttribute("aria-expanded","false"),n.focus()}function x(){for(var t=this;-1===t.className.indexOf("nav-menu");)"li"===t.tagName.toLowerCase()&&(-1!==t.className.indexOf("focus")?t.className=t.className.replace(" focus",""):t.className+=" focus"),t=t.parentElement}}(jQuery),function(){"use strict";var t={"circ-in":function(t){return-1*(Math.sqrt(1-t*t)-1)},"circ-out":function(t){return Math.sqrt(1-(t-=1)*t)},"circ-in-out":function(t){return(t/=.5)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)},"cubic-in":function(t){return t*t*t},"cubic-out":function(t){return--t*t*t+1},"cubic-in-out":function(t){return t<.5?4*t*t*t:(t-1)*(2*t-2)*(2*t-2)+1},"elastic-in":function(t){var e=1.70158,i=0,s=1;if(0==t)return 0;if(1==t)return 1;if(i||(i=.3),s<Math.abs(1)){s=1;e=i/4}else e=i/(2*Math.PI)*Math.asin(1/s);return-s*Math.pow(2,10*(t-=1))*Math.sin((t-e)*(2*Math.PI)/i)},"elastic-out":function(t){var e=1.70158,i=0,s=1;if(0==t)return 0;if(1==t)return 1;if(i||(i=.3),s<Math.abs(1)){s=1;e=i/4}else e=i/(2*Math.PI)*Math.asin(1/s);return s*Math.pow(2,-10*t)*Math.sin((t-e)*(2*Math.PI)/i)+1},"elastic-in-out":function(t){var e=1.70158,i=0,s=1;if(0==t)return 0;if(2==(t/=.5))return 1;if(i||(i=.3*1.5*1),s<Math.abs(1)){s=1;e=i/4}else e=i/(2*Math.PI)*Math.asin(1/s);return t<1?s*Math.pow(2,10*(t-=1))*Math.sin((t-e)*(2*Math.PI)/i)*-.5:s*Math.pow(2,-10*(t-=1))*Math.sin((t-e)*(2*Math.PI)/i)*.5+1},"expo-in":function(t){return 0==t?0:Math.pow(2,10*(t-1))},"expo-out":function(t){return 1==t?1:1-Math.pow(2,-10*t)},"expo-in-out":function(t){return 0==t?0:1==t?1:(t/=.5)<1?.5*Math.pow(2,10*(t-1)):.5*(2-Math.pow(2,-10*--t))},linear:function(t){return t},"quad-in":function(t){return t*t},"quad-out":function(t){return t*(2-t)},"quad-in-out":function(t){return t<.5?2*t*t:(4-2*t)*t-1},"quart-in":function(t){return t*t*t*t},"quart-out":function(t){return 1- --t*t*t*t},"quart-in-out":function(t){return t<.5?8*t*t*t*t:1-8*--t*t*t*t},"quint-in":function(t){return t*t*t*t*t},"quint-out":function(t){return 1+--t*t*t*t*t},"quint-in-out":function(t){return t<.5?16*t*t*t*t*t:1+16*--t*t*t*t*t},"sine-in":function(t){return 1-Math.cos(t*(Math.PI/2))},"sine-out":function(t){return Math.sin(t*(Math.PI/2))},"sine-in-out":function(t){return.5*(1-Math.cos(Math.PI*t))}},e=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.oRequestAnimationFrame,i=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.oCancelAnimationFrame;function s(t,e,i){var s,n={};for(s in t)switch(s){case"fill":case"stroke":n[s]=l(t[s]),n[s].r=t[s].r+(e[s].r-t[s].r)*i,n[s].g=t[s].g+(e[s].g-t[s].g)*i,n[s].b=t[s].b+(e[s].b-t[s].b)*i,n[s].opacity=t[s].opacity+(e[s].opacity-t[s].opacity)*i;break;case"opacity":case"fill-opacity":case"stroke-opacity":case"stroke-width":n[s]=t[s]+(e[s]-t[s])*i}return n}function n(t){var e,i={};for(e in t)switch(e){case"fill":case"stroke":i[e]=I(t[e]);break;case"opacity":case"fill-opacity":case"stroke-opacity":case"stroke-width":i[e]=t[e]}return i}function o(t,e){var i,s=[{},{}];for(i in t)switch(i){case"fill":case"stroke":s[0][i]=P(t[i]),void 0===e[i]&&(s[1][i]=P(t[i]),s[1][i].opacity=0);break;case"opacity":case"fill-opacity":case"stroke-opacity":case"stroke-width":s[0][i]=t[i],void 0===e[i]&&(s[1][i]=1)}for(i in e)switch(i){case"fill":case"stroke":s[1][i]=P(e[i]),void 0===t[i]&&(s[0][i]=P(e[i]),s[0][i].opacity=0);break;case"opacity":case"fill-opacity":case"stroke-opacity":case"stroke-width":s[1][i]=e[i],void 0===t[i]&&(s[0][i]=1)}return s}function a(t,e,i){var s={};for(var n in t)switch(n){case"rotate":s[n]=[0,0,0];for(var o=0;o<3;o++)s[n][o]=t[n][o]+(e[n][o]-t[n][o])*i}return s}function r(t,e,i){for(var s=[],n=0,o=t.length;n<o;n++){s.push([t[n][0]]);for(var a=1,r=t[n].length;a<r;a++)s[n].push(t[n][a]+(e[n][a]-t[n][a])*i)}return s}function l(t){var e;if(t instanceof Array){e=[];for(var i=0,s=t.length;i<s;i++)e[i]=l(t[i]);return e}if(t instanceof Object){for(var n in e={},t)t.hasOwnProperty(n)&&(e[n]=l(t[n]));return e}return t}var h="\t\n\v\f\r   ᠎             　\u2028\u2029",c=new RegExp("([a-z])["+h+",]*((-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?["+h+"]*,?["+h+"]*)+)","ig"),d=new RegExp("(-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?)["+h+"]*,?["+h+"]*","ig"),u=function(t,e){for(var i=[],s=0,n=t.length;n-2*!e>s;s+=2){var o=[{x:+t[s-2],y:+t[s-1]},{x:+t[s],y:+t[s+1]},{x:+t[s+2],y:+t[s+3]},{x:+t[s+4],y:+t[s+5]}];e?s?n-4==s?o[3]={x:+t[0],y:+t[1]}:n-2==s&&(o[2]={x:+t[0],y:+t[1]},o[3]={x:+t[2],y:+t[3]}):o[0]={x:+t[n-2],y:+t[n-1]}:n-4==s?o[3]=o[2]:s||(o[0]={x:+t[s],y:+t[s+1]}),i.push(["C",(-o[0].x+6*o[1].x+o[2].x)/6,(-o[0].y+6*o[1].y+o[2].y)/6,(o[1].x+6*o[2].x-o[3].x)/6,(o[1].y+6*o[2].y-o[3].y)/6,o[2].x,o[2].y])}return i},p=function(t,e,i,s,n){if(null==n&&null==s&&(s=i),t=+t,e=+e,i=+i,s=+s,null!=n)var o=Math.PI/180,a=t+i*Math.cos(-s*o),r=t+i*Math.cos(-n*o),l=[["M",a,e+i*Math.sin(-s*o)],["A",i,i,0,+(n-s>180),0,r,e+i*Math.sin(-n*o)]];else l=[["M",t,e],["m",0,-s],["a",i,s,0,1,1,0,2*s],["a",i,s,0,1,1,0,-2*s],["z"]];return l},m=function(t){if(!(t=function(t){if(!t)return null;if(typeof t==typeof[])return t;var e={a:7,c:6,o:2,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,u:3,z:0},i=[];return String(t).replace(c,function(t,s,n){var o=[],a=s.toLowerCase();if(n.replace(d,function(t,e){e&&o.push(+e)}),"m"==a&&o.length>2&&(i.push([s].concat(o.splice(0,2))),a="l",s="m"==s?"l":"L"),"o"==a&&1==o.length&&i.push([s,o[0]]),"r"==a)i.push([s].concat(o));else for(;o.length>=e[a]&&(i.push([s].concat(o.splice(0,e[a]))),e[a]););}),i}(t))||!t.length)return[["M",0,0]];var e,i=[],s=0,n=0,o=0,a=0,r=0;"M"==t[0][0]&&(o=s=+t[0][1],a=n=+t[0][2],r++,i[0]=["M",s,n]);for(var l,h,m=3==t.length&&"M"==t[0][0]&&"R"==t[1][0].toUpperCase()&&"Z"==t[2][0].toUpperCase(),f=r,g=t.length;f<g;f++){if(i.push(l=[]),(e=(h=t[f])[0])!=e.toUpperCase())switch(l[0]=e.toUpperCase(),l[0]){case"A":l[1]=h[1],l[2]=h[2],l[3]=h[3],l[4]=h[4],l[5]=h[5],l[6]=+h[6]+s,l[7]=+h[7]+n;break;case"V":l[1]=+h[1]+n;break;case"H":l[1]=+h[1]+s;break;case"R":for(var y=[s,n].concat(h.slice(1)),v=2,w=y.length;v<w;v++)y[v]=+y[v]+s,y[++v]=+y[v]+n;i.pop(),i=i.concat(u(y,m));break;case"O":i.pop(),(y=p(s,n,h[1],h[2])).push(y[0]),i=i.concat(y);break;case"U":i.pop(),i=i.concat(p(s,n,h[1],h[2],h[3])),l=["U"].concat(i[i.length-1].slice(-2));break;case"M":o=+h[1]+s,a=+h[2]+n;default:for(v=1,w=h.length;v<w;v++)l[v]=+h[v]+(v%2?s:n)}else if("R"==e)y=[s,n].concat(h.slice(1)),i.pop(),i=i.concat(u(y,m)),l=["R"].concat(h.slice(-2));else if("O"==e)i.pop(),(y=p(s,n,h[1],h[2])).push(y[0]),i=i.concat(y);else if("U"==e)i.pop(),i=i.concat(p(s,n,h[1],h[2],h[3])),l=["U"].concat(i[i.length-1].slice(-2));else for(var b=0,x=h.length;b<x;b++)l[b]=h[b];if("O"!=(e=e.toUpperCase()))switch(l[0]){case"Z":s=+o,n=+a;break;case"H":s=l[1];break;case"V":n=l[1];break;case"M":o=l[l.length-2],a=l[l.length-1];default:s=l[l.length-2],n=l[l.length-1]}}return i},f=function(t,e,i,s){return[t,e,i,s,i,s]},g=function(t,e,i,s,n,o){return[1/3*t+2/3*i,1/3*e+2/3*s,1/3*n+2/3*i,1/3*o+2/3*s,n,o]},y=function(t,e,i,s,n,o,a,r,l,h){var c,d=120*Math.PI/180,u=Math.PI/180*(+n||0),p=[],m=function(t,e,i){return{x:t*Math.cos(i)-e*Math.sin(i),y:t*Math.sin(i)+e*Math.cos(i)}};if(h)E=h[0],I=h[1],C=h[2],S=h[3];else{t=(c=m(t,e,-u)).x,e=c.y,r=(c=m(r,l,-u)).x,l=c.y;Math.cos(Math.PI/180*n),Math.sin(Math.PI/180*n);var f=(t-r)/2,g=(e-l)/2,v=f*f/(i*i)+g*g/(s*s);v>1&&(i*=v=Math.sqrt(v),s*=v);var w=i*i,b=s*s,x=(o==a?-1:1)*Math.sqrt(Math.abs((w*b-w*g*g-b*f*f)/(w*g*g+b*f*f))),C=x*i*g/s+(t+r)/2,S=x*-s*f/i+(e+l)/2,E=Math.asin(((e-S)/s).toFixed(9)),I=Math.asin(((l-S)/s).toFixed(9));E=t<C?Math.PI-E:E,I=r<C?Math.PI-I:I,E<0&&(E=2*Math.PI+E),I<0&&(I=2*Math.PI+I),a&&E>I&&(E-=2*Math.PI),!a&&I>E&&(I-=2*Math.PI)}var k=I-E;if(Math.abs(k)>d){var M=I,P=r,T=l;I=E+d*(a&&I>E?1:-1),r=C+i*Math.cos(I),l=S+s*Math.sin(I),p=y(r,l,i,s,n,0,a,P,T,[I,M,C,S])}k=I-E;var A=Math.cos(E),N=Math.sin(E),L=Math.cos(I),_=Math.sin(I),O=Math.tan(k/4),R=4/3*i*O,z=4/3*s*O,D=[t,e],B=[t+R*N,e-z*A],K=[r+R*_,l-z*L],F=[r,l];if(B[0]=2*D[0]-B[0],B[1]=2*D[1]-B[1],h)return[B,K,F].concat(p);for(var G=[],V=0,W=(p=[B,K,F].concat(p).join().split(",")).length;V<W;V++)G[V]=V%2?m(p[V-1],p[V],u).y:m(p[V],p[V+1],u).x;return G},v=function(t,e){for(var i=m(t),s=e&&m(e),n={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},o={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},a=function(t,e,i){var s,n;if(!t)return["C",e.x,e.y,e.x,e.y,e.x,e.y];switch(!(t[0]in{T:1,Q:1})&&(e.qx=e.qy=null),t[0]){case"M":e.X=t[1],e.Y=t[2];break;case"A":t=["C"].concat(y.apply(0,[e.x,e.y].concat(t.slice(1))));break;case"S":"C"==i||"S"==i?(s=2*e.x-e.bx,n=2*e.y-e.by):(s=e.x,n=e.y),t=["C",s,n].concat(t.slice(1));break;case"T":"Q"==i||"T"==i?(e.qx=2*e.x-e.qx,e.qy=2*e.y-e.qy):(e.qx=e.x,e.qy=e.y),t=["C"].concat(g(e.x,e.y,e.qx,e.qy,t[1],t[2]));break;case"Q":e.qx=t[1],e.qy=t[2],t=["C"].concat(g(e.x,e.y,t[1],t[2],t[3],t[4]));break;case"L":t=["C"].concat(f(e.x,e.y,t[1],t[2]));break;case"H":t=["C"].concat(f(e.x,e.y,t[1],e.y));break;case"V":t=["C"].concat(f(e.x,e.y,e.x,t[1]));break;case"Z":t=["C"].concat(f(e.x,e.y,e.X,e.Y))}return t},r=function(t,e){if(t[e].length>7){t[e].shift();for(var n=t[e];n.length;)h[e]="A",s&&(c[e]="A"),t.splice(e++,0,["C"].concat(n.splice(0,6)));t.splice(e,1),v=Math.max(i.length,s&&s.length||0)}},l=function(t,e,n,o,a){t&&e&&"M"==t[a][0]&&"M"!=e[a][0]&&(e.splice(a,0,["M",o.x,o.y]),n.bx=0,n.by=0,n.x=t[a][1],n.y=t[a][2],v=Math.max(i.length,s&&s.length||0))},h=[],c=[],d="",u="",p=0,v=Math.max(i.length,s&&s.length||0);p<v;p++){i[p]&&(d=i[p][0]),"C"!=d&&(h[p]=d,p&&(u=h[p-1])),i[p]=a(i[p],n,u),"A"!=h[p]&&"C"==d&&(h[p]="C"),r(i,p),s&&(s[p]&&(d=s[p][0]),"C"!=d&&(c[p]=d,p&&(u=c[p-1])),s[p]=a(s[p],o,u),"A"!=c[p]&&"C"==d&&(c[p]="C"),r(s,p)),l(i,s,n,o,p),l(s,i,o,n,p);var w=i[p],b=s&&s[p],x=w.length,C=s&&b.length;n.x=w[x-2],n.y=w[x-1],n.bx=parseFloat(w[x-4])||n.x,n.by=parseFloat(w[x-3])||n.y,o.bx=s&&(parseFloat(b[C-4])||o.x),o.by=s&&(parseFloat(b[C-3])||o.y),o.x=s&&b[C-2],o.y=s&&b[C-1]}return s?[i,s]:i},w=function(t,e,i,s,n,o,a,r){for(var l,h,c,d,u,p,m,f,g=[],y=[[],[]],v=0;v<2;++v)if(0==v?(h=6*t-12*i+6*n,l=-3*t+9*i-9*n+3*a,c=3*i-3*t):(h=6*e-12*s+6*o,l=-3*e+9*s-9*o+3*r,c=3*s-3*e),Math.abs(l)<1e-12){if(Math.abs(h)<1e-12)continue;0<(d=-c/h)&&d<1&&g.push(d)}else m=h*h-4*c*l,f=Math.sqrt(m),m<0||(0<(u=(-h+f)/(2*l))&&u<1&&g.push(u),0<(p=(-h-f)/(2*l))&&p<1&&g.push(p));for(var w,b=g.length,x=b;b--;)w=1-(d=g[b]),y[0][b]=w*w*w*t+3*w*w*d*i+3*w*d*d*n+d*d*d*a,y[1][b]=w*w*w*e+3*w*w*d*s+3*w*d*d*o+d*d*d*r;return y[0][x]=t,y[1][x]=e,y[0][x+1]=a,y[1][x+1]=r,y[0].length=y[1].length=x+2,{min:{x:Math.min.apply(0,y[0]),y:Math.min.apply(0,y[1])},max:{x:Math.max.apply(0,y[0]),y:Math.max.apply(0,y[1])}}},b=function(t){for(var e,i=0,s=0,n=[],o=[],a=0,r=t.length;a<r;a++)if("M"==(e=t[a])[0])i=e[1],s=e[2],n.push(i),o.push(s);else{var l=w(i,s,e[1],e[2],e[3],e[4],e[5],e[6]);n=n.concat(l.min.x,l.max.x),o=o.concat(l.min.y,l.max.y),i=e[5],s=e[6]}var h=Math.min.apply(0,n),c=Math.min.apply(0,o);return function(t,e,i,s){return null==t&&(t=e=i=s=0),null==e&&(e=t.y,i=t.width,s=t.height,t=t.x),{x:t,y:e,w:i,h:s,cx:t+i/2,cy:e+s/2}}(h,c,Math.max.apply(0,n)-h,Math.max.apply(0,o)-c)},x=/,?([a-z]),?/gi,C={hs:1,rg:1},S=/^\s*((#[a-f\d]{6})|(#[a-f\d]{3})|rgba?\(\s*([\d\.]+%?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+%?(?:\s*,\s*[\d\.]+%?)?)\s*\)|hsba?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?%?)\s*\)|hsla?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?%?)\s*\))\s*$/i,E=new RegExp("["+h+"]*,["+h+"]*"),I=function(t){var e=Math.round;return"rgba("+[e(t.r),e(t.g),e(t.b),+t.opacity.toFixed(2)]+")"},k=function(t){var e=window.document.getElementsByTagName("head")[0]||window.document.getElementsByTagName("svg")[0],i="rgb(255, 0, 0)";return(k=function(t){if("red"==t.toLowerCase())return i;e.style.color=i,e.style.color=t;var s=window.document.defaultView.getComputedStyle(e,"").getPropertyValue("color");return s==i?null:s})(t)},M=function(t,e,i,s){return{r:t=Math.round(255*t),g:e=Math.round(255*e),b:i=Math.round(255*i),opacity:isFinite(s)?s:1}},P=function(t){if(!t||(t=String(t)).indexOf("-")+1)return{r:-1,g:-1,b:-1,opacity:-1,error:1};if("none"==t)return{r:-1,g:-1,b:-1,opacity:-1};if(!C.hasOwnProperty(t.toLowerCase().substring(0,2))&&"#"!=t.charAt()&&(t=k(t)),!t)return{r:-1,g:-1,b:-1,opacity:-1,error:1};var e,i,s,n,o,a,r,l,h,c,d,u,p,m,f,g=t.match(S);return g?(g[2]&&(s=parseInt(g[2].substring(5),16),i=parseInt(g[2].substring(3,5),16),e=parseInt(g[2].substring(1,3),16)),g[3]&&(s=parseInt((o=g[3].charAt(3))+o,16),i=parseInt((o=g[3].charAt(2))+o,16),e=parseInt((o=g[3].charAt(1))+o,16)),g[4]&&(a=g[4].split(E),e=parseFloat(a[0]),"%"==a[0].slice(-1)&&(e*=2.55),i=parseFloat(a[1]),"%"==a[1].slice(-1)&&(i*=2.55),s=parseFloat(a[2]),"%"==a[2].slice(-1)&&(s*=2.55),"rgba"==g[1].toLowerCase().slice(0,4)&&(n=parseFloat(a[3])),a[3]&&"%"==a[3].slice(-1)&&(n/=100)),g[5]?(a=g[5].split(E),e=parseFloat(a[0]),"%"==a[0].slice(-1)&&(e/=100),i=parseFloat(a[1]),"%"==a[1].slice(-1)&&(i/=100),s=parseFloat(a[2]),"%"==a[2].slice(-1)&&(s/=100),("deg"==a[0].slice(-3)||"°"==a[0].slice(-1))&&(e/=360),"hsba"==g[1].toLowerCase().slice(0,4)&&(n=parseFloat(a[3])),a[3]&&"%"==a[3].slice(-1)&&(n/=100),l=i,h=s,c=n,typeof(r=e)==typeof{}&&"h"in r&&"s"in r&&"b"in r&&(h=r.b,l=r.s,c=(r=r.h).o),r=(r*=360)%360/60,m=(f=h*l)*(1-Math.abs(r%2-1)),d=u=p=h-f,M(d+=[f,m,0,0,m,f][r=~~r],u+=[m,f,f,m,0,0][r],p+=[0,0,m,f,f,m][r],c)):g[6]?(a=g[6].split(E),e=parseFloat(a[0]),"%"==a[0].slice(-1)&&(e/=100),i=parseFloat(a[1]),"%"==a[1].slice(-1)&&(i/=100),s=parseFloat(a[2]),"%"==a[2].slice(-1)&&(s/=100),("deg"==a[0].slice(-3)||"°"==a[0].slice(-1))&&(e/=360),"hsla"==g[1].toLowerCase().slice(0,4)&&(n=parseFloat(a[3])),a[3]&&"%"==a[3].slice(-1)&&(n/=100),function(t,e,i,s){var n,o,a,r,l;return typeof t==typeof{}&&"h"in t&&"s"in t&&"l"in t&&(i=t.l,e=t.s,t=t.h),(t>1||e>1||i>1)&&(t/=360,e/=100,i/=100),t=(t*=360)%360/60,r=(l=2*e*(i<.5?i:1-i))*(1-Math.abs(t%2-1)),n=o=a=i-l/2,M(n+=[l,r,0,0,r,l][t=~~t],o+=[r,l,l,r,0,0][t],a+=[0,0,r,l,l,r][t],s)}(e,i,s,n)):(e=Math.min(Math.round(e),255),i=Math.min(Math.round(i),255),s=Math.min(Math.round(s),255),n=Math.min(Math.max(n,0),1),(g={r:e,g:i,b:s}).opacity=isFinite(n)?n:1,g)):{r:-1,g:-1,b:-1,opacity:-1,error:1}};function T(t,i,s){if(!t)throw new Error('SVGMorpheus > "element" is required');if("string"==typeof t&&!(t=document.querySelector(t)))throw new Error('SVGMorpheus > "element" query is not related to an existing DOM node');if(i&&typeof i!=typeof{})throw new Error('SVGMorpheus > "options" parameter must be an object');if(i=i||{},s&&"function"!=typeof s)throw new Error('SVGMorpheus > "callback" parameter must be a function');var n=this;this._icons={},this._curIconId=i.iconId||"",this._toIconId="",this._curIconItems=[],this._fromIconItems=[],this._toIconItems=[],this._morphNodes=[],this._morphG,this._startTime,this._defDuration=i.duration||750,this._defEasing=i.easing||"quad-in-out",this._defRotation=i.rotation||"clock",this._defCallback=s||function(){},this._duration=this._defDuration,this._easing=this._defEasing,this._rotation=this._defRotation,this._callback=this._defCallback,this._rafid,this._fnTick=function(t){n._startTime||(n._startTime=t);var i=Math.min((t-n._startTime)/n._duration,1);n._updateAnimationProgress(i),i<1?n._rafid=e(n._fnTick):""!=n._toIconId&&n._animationEnd()},"SVG"===t.nodeName.toUpperCase()?this._svgDoc=t:this._svgDoc=t.getSVGDocument(),this._svgDoc?n._init():t.addEventListener("load",function(){n._svgDoc=t.getSVGDocument(),n._init()},!1)}T.prototype._init=function(){if("SVG"!==this._svgDoc.nodeName.toUpperCase()&&(this._svgDoc=this._svgDoc.getElementsByTagName("svg")[0]),this._svgDoc){var t,e,i,s,n,o,a,r="";for(t=this._svgDoc.childNodes.length-1;t>=0;t--){var l=this._svgDoc.childNodes[t];if("G"===l.nodeName.toUpperCase()&&(e=l.getAttribute("id"))){for(i=[],n=0,o=l.childNodes.length;n<o;n++){var h=l.childNodes[n];switch(s={path:"",attrs:{},style:{}},h.nodeName.toUpperCase()){case"PATH":s.path=h.getAttribute("d");break;case"CIRCLE":var c=1*h.getAttribute("cx"),d=1*h.getAttribute("cy"),u=1*h.getAttribute("r");s.path="M"+(c-u)+","+d+"a"+u+","+u+" 0 1,0 "+2*u+",0a"+u+","+u+" 0 1,0 -"+2*u+",0z";break;case"ELLIPSE":c=1*h.getAttribute("cx"),d=1*h.getAttribute("cy");var p=1*h.getAttribute("rx"),m=1*h.getAttribute("ry");s.path="M"+(c-p)+","+d+"a"+p+","+m+" 0 1,0 "+2*p+",0a"+p+","+m+" 0 1,0 -"+2*p+",0z";break;case"RECT":var f=1*h.getAttribute("x"),g=1*h.getAttribute("y"),y=1*h.getAttribute("width"),v=1*h.getAttribute("height");p=1*h.getAttribute("rx"),m=1*h.getAttribute("ry");s.path=p||m?"M"+(f+p)+","+g+"l"+(y-2*p)+",0a"+p+","+m+" 0 0,1 "+p+","+m+"l0,"+(v-2*m)+"a"+p+","+m+" 0 0,1 -"+p+","+m+"l"+(2*p-y)+",0a"+p+","+m+" 0 0,1 -"+p+",-"+m+"l0,"+(2*m-v)+"a"+p+","+m+" 0 0,1 "+p+",-"+m+"z":"M"+f+","+g+"l"+y+",0l0,"+v+"l-"+y+",0z";break;case"POLYGON":for(var w=h.getAttribute("points").split(/\s+/),b="",x=0,C=w.length;x<C;x++)b+=(x?"L":"M")+w[x];s.path=b+"z";break;case"LINE":var S=1*h.getAttribute("x1"),E=1*h.getAttribute("y1"),I=1*h.getAttribute("x2"),k=1*h.getAttribute("y2");s.path="M"+S+","+E+"L"+I+","+k+"z"}if(""!=s.path){x=0;for(var M=h.attributes.length;x<M;x++){var P=h.attributes[x];if(P.specified){var T=P.name.toLowerCase();switch(T){case"fill":case"fill-opacity":case"opacity":case"stroke":case"stroke-opacity":case"stroke-width":s.attrs[T]=P.value}}}for(var A=0,N=h.style.length;A<N;A++){var L=h.style[A];switch(L){case"fill":case"fill-opacity":case"opacity":case"stroke":case"stroke-opacity":case"stroke-width":s.style[L]=h.style[L]}}i.push(s)}}i.length>0&&(a={id:e,items:i},this._icons[e]=a),this._morphG?this._svgDoc.removeChild(l):(r=e,this._morphG=document.createElementNS("http://www.w3.org/2000/svg","g"),this._svgDoc.replaceChild(this._morphG,l))}}var _=this._curIconId||r;""!==_&&(this._setupAnimation(_),this._updateAnimationProgress(1),this._animationEnd())}},T.prototype._setupAnimation=function(t){if(t&&this._icons[t]){var e,i;for(this._toIconId=t,this._startTime=void 0,this._fromIconItems=l(this._curIconItems),this._toIconItems=l(this._icons[t].items),e=0,i=this._morphNodes.length;e<i;e++){var s=this._morphNodes[e];s.fromIconItemIdx=e,s.toIconItemIdx=e}var a,r=Math.max(this._fromIconItems.length,this._toIconItems.length);for(e=0;e<r;e++)if(this._fromIconItems[e]||(this._toIconItems[e]?(a=b(v(this._toIconItems[e].path)),this._fromIconItems.push({path:"M"+a.cx+","+a.cy+"l0,0",attrs:{},style:{},trans:{rotate:[0,a.cx,a.cy]}})):this._fromIconItems.push({path:"M0,0l0,0",attrs:{},style:{},trans:{rotate:[0,0,0]}})),this._toIconItems[e]||(this._fromIconItems[e]?(a=b(v(this._fromIconItems[e].path)),this._toIconItems.push({path:"M"+a.cx+","+a.cy+"l0,0",attrs:{},style:{},trans:{rotate:[0,a.cx,a.cy]}})):this._toIconItems.push({path:"M0,0l0,0",attrs:{},style:{},trans:{rotate:[0,0,0]}})),!this._morphNodes[e]){var h=document.createElementNS("http://www.w3.org/2000/svg","path");this._morphG.appendChild(h),this._morphNodes.push({node:h,fromIconItemIdx:e,toIconItemIdx:e})}for(e=0;e<r;e++){var c=this._fromIconItems[e],d=this._toIconItems[e],u=v(this._fromIconItems[e].path,this._toIconItems[e].path);c.curve=u[0],d.curve=u[1];var p=o(this._fromIconItems[e].attrs,this._toIconItems[e].attrs);c.attrsNorm=p[0],d.attrsNorm=p[1],c.attrs=n(c.attrsNorm),d.attrs=n(d.attrsNorm);var m=o(this._fromIconItems[e].style,this._toIconItems[e].style);c.styleNorm=m[0],d.styleNorm=m[1],c.style=n(c.styleNorm),d.style=n(d.styleNorm),a=b(d.curve),d.trans={rotate:[0,a.cx,a.cy]};var f,g=this._rotation;switch("random"===g&&(g=Math.random()<.5?"counterclock":"clock"),g){case"none":c.trans.rotate&&(d.trans.rotate[0]=c.trans.rotate[0]);break;case"counterclock":c.trans.rotate?(d.trans.rotate[0]=c.trans.rotate[0]-360,f=-c.trans.rotate[0]%360,d.trans.rotate[0]+=f<180?f:f-360):d.trans.rotate[0]=-360;break;default:c.trans.rotate?(d.trans.rotate[0]=c.trans.rotate[0]+360,f=c.trans.rotate[0]%360,d.trans.rotate[0]+=f<180?-f:360-f):d.trans.rotate[0]=360}}this._curIconItems=l(this._fromIconItems)}},T.prototype._updateAnimationProgress=function(e){var i,o,l,h,c,d;for(e=t[this._easing](e),i=0,h=this._curIconItems.length;i<h;i++)this._curIconItems[i].curve=r(this._fromIconItems[i].curve,this._toIconItems[i].curve,e),this._curIconItems[i].path=this._curIconItems[i].curve.join(",").replace(x,"$1"),this._curIconItems[i].attrsNorm=s(this._fromIconItems[i].attrsNorm,this._toIconItems[i].attrsNorm,e),this._curIconItems[i].attrs=n(this._curIconItems[i].attrsNorm),this._curIconItems[i].styleNorm=s(this._fromIconItems[i].styleNorm,this._toIconItems[i].styleNorm,e),this._curIconItems[i].style=n(this._curIconItems[i].styleNorm),this._curIconItems[i].trans=a(this._fromIconItems[i].trans,this._toIconItems[i].trans,e),this._curIconItems[i].transStr=(c=this._curIconItems[i].trans,d=void 0,d="",c.rotate&&(d+="rotate("+c.rotate.join(" ")+")"),d);for(i=0,h=this._morphNodes.length;i<h;i++){var u=this._morphNodes[i];u.node.setAttribute("d",this._curIconItems[i].path);var p=this._curIconItems[i].attrs;for(o in p)u.node.setAttribute(o,p[o]);var m=this._curIconItems[i].style;for(l in m)u.node.style[l]=m[l];u.node.setAttribute("transform",this._curIconItems[i].transStr)}},T.prototype._animationEnd=function(){for(var t=this._morphNodes.length-1;t>=0;t--){var e=this._morphNodes[t];this._icons[this._toIconId].items[t]?e.node.setAttribute("d",this._icons[this._toIconId].items[t].path):(e.node.parentNode.removeChild(e.node),this._morphNodes.splice(t,1))}this._curIconId=this._toIconId,this._toIconId="",this._callback()},T.prototype.to=function(t,s,n){if(t!==this._toIconId){if(s&&typeof s!=typeof{})throw new Error('SVGMorpheus.to() > "options" parameter must be an object');if(s=s||{},n&&"function"!=typeof n)throw new Error('SVGMorpheus.to() > "callback" parameter must be a function');i(this._rafid),this._duration=s.duration||this._defDuration,this._easing=s.easing||this._defEasing,this._rotation=s.rotation||this._defRotation,this._callback=n||this._defCallback,this._setupAnimation(t),this._rafid=e(this._fnTick)}},T.prototype.registerEasing=function(e,i){t[e]=i},"function"==typeof define&&define.amd?define(function(){return T}):"undefined"!=typeof module&&void 0!==module.exports?module.exports=T:window.SVGMorpheus=T}(),function(t,e){"object"==typeof exports?module.exports=e(t):"function"==typeof define&&define.amd?define([],e):t.LazyLoad=e(t)}("undefined"!=typeof global?global:this.window||this.global,function(t){"use strict";"function"==typeof define&&define.amd&&(t=window);const e={src:"data-src",srcmobile:"data-src-mobile",srcset:"data-srcset",selector:".lazyload",root:null,rootMargin:"0px",threshold:0},i=function(){let t={},e=!1,s=0,n=arguments.length;"[object Boolean]"===Object.prototype.toString.call(arguments[0])&&(e=arguments[0],s++);let o=function(s){for(let n in s)Object.prototype.hasOwnProperty.call(s,n)&&(e&&"[object Object]"===Object.prototype.toString.call(s[n])?t[n]=i(!0,t[n],s[n]):t[n]=s[n])};for(;s<n;s++){o(arguments[s])}return t};function s(t,s){this.settings=i(e,s||{}),this.images=t||document.querySelectorAll(this.settings.selector),this.observer=null,this.init()}if(s.prototype={init:function(){if(!t.IntersectionObserver)return void this.loadImages();let e=this,i={root:this.settings.root,rootMargin:this.settings.rootMargin,threshold:[this.settings.threshold]};this.observer=new IntersectionObserver(function(t){Array.prototype.forEach.call(t,function(t){if(t.isIntersecting){const i=t.target;i.nextElementSibling.classList.add("reveal"),e.observer.unobserve(t.target);let s=i.getAttribute(e.settings.src),n=(i.getAttribute(e.settings.srcset),i.getAttribute(e.settings.srcmobile));document.documentElement.clientWidth<600?i.nextElementSibling.style.backgroundImage="url("+n+")":i.nextElementSibling.style.backgroundImage="url("+s+")"}})},i),Array.prototype.forEach.call(this.images,function(t){e.observer.observe(t)})},loadAndDestroy:function(){this.settings&&(this.loadImages(),this.destroy())},loadImages:function(){if(!this.settings)return;let t=this;Array.prototype.forEach.call(this.images,function(e){let i=e.getAttribute(t.settings.src),s=e.getAttribute(t.settings.srcset),n=e.getAttribute(t.settings.srcmobile);"img"===e.tagName.toLowerCase()?(i&&(e.src=i),s&&(e.srcset=s),n&&(e.srcmobile=n)):document.documentElement.clientWidth<600?e.style.backgroundImage="url('"+n+"')":e.style.backgroundImage="url('"+i+"')"})},destroy:function(){this.settings&&(this.observer.disconnect(),this.settings=null)}},t.lazyload=function(t,e){return new s(t,e)},t.jQuery){const e=t.jQuery;e.fn.lazyload=function(t){return(t=t||{}).attribute=t.attribute||"data-src",new s(e.makeArray(this),t),this}}return s});var initButton=document.getElementById("elementId");void 0!==initButton&&null!=initButton&&(initButton.onclick=function fun(){!function(window){var JSONP=function(){var t,e,i,s=0,n=this;return{get:function(o,a,r){for(i in e="?",a=a||{})a.hasOwnProperty(i)&&(e+=encodeURIComponent(i)+"="+encodeURIComponent(a[i])+"&");var l="json"+ ++s;return n[l]=function(t){r(t);try{delete n[l]}catch(t){}n[l]=null},function(e){var i=document.createElement("script"),s=!1;i.src=e,i.async=!0,i.onload=i.onreadystatechange=function(){s||this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState||(s=!0,i.onload=i.onreadystatechange=null,i&&i.parentNode&&i.parentNode.removeChild(i))},t||(t=document.getElementsByTagName("head")[0])||(t=document.body),t.appendChild(i)}(o+e+"callback="+l),l}}}(),CORS={request:function(t,e,i){if(this.calledByExtension())return this._callbacks[this._callbackId++]=i,void window.postMessage(JSON.stringify({from:"kickassapp-page",url:t,type:"callApi",params:e}),"*");e=e||{};var s="?";for(key in e)e.hasOwnProperty(key)&&(s+=encodeURIComponent(key)+"="+encodeURIComponent(e[key])+"&");var n=new XMLHttpRequest;n.onreadystatechange=function(){4==n.readyState&&i(JSON.parse(n.responseText))},n.open("GET",t+s),n.withCredentials=!0,n.setRequestHeader("Content-Type","application/json"),n.send()},calledByExtension:function(){return!!document.getElementById("kickass-has-been-initialized-yes-yes-yes")},_callbacks:{},_callbackId:0};function getGlobalNamespace(){return window&&window.INSTALL_SCOPE?window.INSTALL_SCOPE:window}CORS.calledByExtension()&&window.addEventListener("message",function(t){var e;try{e=JSON.parse(t.data)}catch(t){return}if("kickassapp-extension"===e.from&&"kickassapp-extension-version1"===e.sanityCheck){var i=e.payload;"response"===i.type?(CORS._callbacks[i.requestId](i.body),delete CORS._callbacks[i.requestId]):"destroy"===i.type&&window.KICKASSGAME.destroy()}},!1);var Class=function(t){var e=function(){return e.$prototyping?this:"function"==typeof this.initialize?this.initialize.apply(this,arguments):void 0};for(var i in t.Extends&&(e.parent=t.Extends,t.Extends.$prototyping=!0,e.prototype=new t.Extends,t.Extends.$prototyping=!1),t)t.hasOwnProperty(i)&&(e.prototype[i]=t[i]);return e};"undefined"!=typeof exports&&(exports.Class=Class);var Vector=new Class({initialize:function(t,e){"object"==typeof t?(this.x=t.x,this.y=t.y):(this.x=t,this.y=e)},cp:function(){return new Vector(this.x,this.y)},mul:function(t){return this.x*=t,this.y*=t,this},mulNew:function(t){return new Vector(this.x*t,this.y*t)},div:function(t){return this.x/=t,this.y/=t,this},divNew:function(t){return new Vector(this.x/t,this.y/t)},add:function(t){return this.x+=t.x,this.y+=t.y,this},addNew:function(t){return new Vector(this.x+t.x,this.y+t.y)},sub:function(t){return this.x-=t.x,this.y-=t.y,this},subNew:function(t){return new Vector(this.x-t.x,this.y-t.y)},rotate:function(t){var e=this.x,i=this.y;return this.x=e*Math.cos(t)-Math.sin(t)*i,this.y=e*Math.sin(t)+Math.cos(t)*i,this},rotateNew:function(t){return this.cp().rotate(t)},setAngle:function(t){var e=this.len();return this.x=Math.cos(t)*e,this.y=Math.sin(t)*e,this},setAngleNew:function(t){return this.cp().setAngle(t)},setLength:function(t){var e=this.len();return e?this.mul(t/e):this.x=this.y=t,this},setLengthNew:function(t){return this.cp().setLength(t)},normalize:function(){var t=this.len();return 0==t?this:(this.x/=t,this.y/=t,this)},normalizeNew:function(){return this.cp().normalize()},angle:function(){return Math.atan2(this.y,this.x)},collidesWith:function(t){return this.x>t.x&&this.y>t.y&&this.x<t.x+t.width&&this.y<t.y+t.height},len:function(){var t=Math.sqrt(this.x*this.x+this.y*this.y);return t<.005&&t>-.005?0:t},is:function(t){return"object"==typeof t&&this.x==t.x&&this.y==t.y},dot:function(t){return this.x*t.x+this.y*t.y},inTriangle:function(t,e,i){var s=i.subNew(t),n=e.subNew(t),o=p.subNew(t),a=s.dot(s),r=s.dot(n),l=s.dot(o),h=n.dot(n),c=n.dot(o),d=1/(a*h-r*r),u=(h*l-r*c)*d,m=(a*c-r*l)*d;return u>0&&m>0&&u+m<1},distanceFrom:function(t){return Math.sqrt(Math.pow(this.x-t.x,2),Math.pow(this.y-t.y,2))},toString:function(){return"[Vector("+this.x+", "+this.y+") angle: "+this.angle()+", length: "+this.len()+"]"}});"undefined"!=typeof exports&&(exports.Vector=Vector);var Rect=new Class({initialize:function(t,e,i,s){this.pos=new Vector(t,e),this.size={width:i,height:s}},hasPoint:function(t){return t.x>this.getLeft()&&t.x<this.getRight()&&t.y>this.getTop()&&t.y<this.getBottom()},setLeft:function(t){this.pos.x=t+this.size.width/2},setTop:function(t){this.pos.y=t+this.size.height/2},getLeft:function(){return this.pos.x-this.size.width/2},getTop:function(){return this.pos.y-this.size.height/2},getRight:function(){return this.pos.x+this.size.width/2},getBottom:function(){return this.pos.y+this.size.height/2},cp:function(){return new Rect(this.pos.x,this.pos.y,this.size.width,this.size.height)}});"undefined"!=typeof exports&&(exports.Rect=Rect);var Fx=new Class({initialize:function(){this.listeners=[],this.tweens={},this.running={}},addListener:function(t){this.listeners.push(t)},add:function(t,e){if((e=e||{}).duration=e.duration||500,e.transition=e.transition||Tween.Linear,e.repeats=void 0!==e.repeats&&e.repeats,!e.tweens){var i=e.start||0,s=void 0===e.end?1:e.end;e.tweens=[[i,s]]}this.tweens[t]=e},update:function(t){for(var e in t="number"==typeof t?t:now(),this.tweens)if(this.tweens.hasOwnProperty(e)){if(!this.running[e]){this.tweenStart(e,t);continue}var i=this.tweens[e],s=t-this.running[e].startTime;if(s>i.duration){this.tweenFinished(i,e);continue}for(var n,o=i.transition(s/i.duration),a=[],r=0;n=i.tweens[r];r++){var l=o*(n[1]-n[0])+n[0];a.push(l)}this.fire(e,a,o)}},tweenStart:function(t,e){this.running[t]={startTime:e};for(var i,s=[],n=0;i=this.tweens[t].tweens[n];n++)s.push(i[0]);this.fire(t,s,0)},tweenFinished:function(t,e){for(var i,s=[],n=0;i=t.tweens[n];n++)s.push(i[1]);if(this.fire(e,s,1),!t.repeats)return delete this.running[e],void delete this.tweens[e];this.tweenStart(e,now())},fire:function(t,e,i){for(var s,n=0;s=this.listeners[n];n++)s.set.call(s,t,e,i)}}),Tween={Linear:function(t){return t},Quadratic:function(t){return t*t},Quintic:function(t){return t*t*t},Shake:function(t){return Math.sin(t)}},GameGlobals={FPS:60,useAnimationFrame:!1,boids:{flockRadius:400,size:100},path:function(){return"https://kickassapp.com/"+Array.prototype.slice.call(arguments).join("")},hasCanvas:void 0!==document.createElement("canvas").getContext,bulletColor:"#131a50"};function now(){return(new Date).getTime()}function bind(t,e){return function(){return e.apply(t,arguments)}}function each(t,e,i){if("function"==typeof t.forEach)return t.forEach(e,i),t;for(var s in t)t.hasOwnProperty(s)&&e.call(i||window,t[s],s);return t}function addEvent(t,e,i){t.addEventListener?t.addEventListener(e,i,!1):t.attachEvent&&(t["e"+e+i]=i,t[e+i]=function(){return t["e"+e+i](window.event)},t.attachEvent("on"+e,t[e+i]))}function removeEvent(t,e,i){t.removeEventListener?t.removeEventListener(e,i,!1):t.detachEvent&&(t.detachEvent("on"+e,t[e+i]),t[e+i]=null,t["e"+e+i]=null)}function stopEvent(t){t.stopPropogation&&t.stopPropogation(),t.preventDefault&&t.preventDefault(),t.returnValue=!1}function elementIsContainedIn(t,e){return element.contains?t.contains(e):!!(16&t.compareDocumentPosition(e))}function code(t){var e={38:"up",40:"down",37:"left",39:"right",27:"esc"};return e[t]?e[t]:String.fromCharCode(t)}function random(t,e){return Math.floor(Math.random()*(e-t+1)+t)}function getRect(t){if("function"==typeof t.getBoundingClientRect){var e=t.getBoundingClientRect(),i=window.pageXOffset,s=window.pageYOffset;return{width:e.width,height:e.height,left:e.left+i,top:e.top+s}}e={width:t.offsetWidth,height:t.offsetHeight,left:0,top:0};for(var n=t;n;)e.left+=n.offsetLeft,e.top+=n.offsetTop,n=n.offsetParent;return e}function getCompatElement(){var t=document;return t.compatMode&&"CSS1Compat"!=t.compatMode?t.body:t.documentElement}function getScrollSize(){var t=getCompatElement(),e={x:t.clientWidth,y:t.clientHeight},i=document.body;return{x:Math.max(t.scrollWidth,i.scrollWidth,e.x),y:Math.max(t.scrollHeight,i.scrollHeight,e.y)}}function getStyle(t,e){return t.style[e]?t.style[e]:t.currentStyle?t.currentStyle[e]:document.defaultView.getComputedStyle(t,null).getPropertyValue(e)}function setStyles(t,e){for(var i in e)if(e.hasOwnProperty(i)){var s=e[i];"number"==typeof s&&"opacity"!==i&&"zIndex"!==i&&(s+="px"),t.style[i]=s}}function hasClass(t,e){return t.className.match(new RegExp("(\\s|^)"+e+"(\\s|$)"))}function addClass(t,e){hasClass(t,e)||(t.className+=" "+e)}function removeClass(t,e){if(hasClass(t,e)){var i=new RegExp("(\\s|^)"+e+"(\\s|$)");t.className=t.className.replace(i," ")}}function cloneElement(t){return t.cloneNode(!0)}function newElement(t,e){var i=document.createElement(t);for(var s in e)e.hasOwnProperty(s)&&("styles"===s?setStyles(i,e[s]):i[s]=e[s]);return i}window.GameGlobals=GameGlobals,Array.prototype.indexOf||(Array.prototype.indexOf=function(t){if(null==this)throw new TypeError;var e=Object(this),i=e.length>>>0;if(0===i)return-1;var s=0;if(arguments.length>0&&((s=Number(arguments[1]))!=s?s=0:0!==s&&s!==1/0&&s!==-1/0&&(s=(s>0||-1)*Math.floor(Math.abs(s)))),s>=i)return-1;for(var n=s>=0?s:Math.max(i-Math.abs(s),0);n<i;n++)if(n in e&&e[n]===t)return n;return-1});var requestAnimFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t,e){window.setTimeout(t,1e3/60)};function delay(t,e,i){return setTimeout(bind(i,e),t)}var KickAss=new Class({initialize:function(t){t&&t.mySite&&(this.mySite=t.mySite),this.players=[],this.elements=[],this.weaponClass=Weapons[1].cannonClass,this.scrollPos=new Vector(0,0),this.scrollSize=new Vector(0,0),this.windowSize={width:0,height:0},this.updateWindowInfo(),this.bulletManager=new BulletManager(this),this.bulletManager.updateEnemyIndex(),this.explosionManager=new ExplosionManager(this),this.ui=new UIManager(this),this.bombManager=new BombManager(this),this.menuManager=new MenuManager(this),this.menuManager.create(),void 0!==StatisticsManager&&(this.statisticsManager=new StatisticsManager(this)),this.sessionManager=new SessionManager(this),this.lastUpdate=now(),this.keyMap={},this.keydownEvent=bind(this,this.keydown),this.keyupEvent=bind(this,this.keyup),this.multiplier=10,this.isCampaign()?this.audioManager={explosion:new AudioManager(GameGlobals.path("static/sounds/game/explosion"),["mp3","ogg"]),shot:new AudioManager(GameGlobals.path("static/sounds/game/shot"),["mp3","ogg"])}:this.audioManager={},window.KickAssStyle&&"white"===window.KickAssStyle&&(GameGlobals.bulletColor="white"),addEvent(document,"keydown",this.keydownEvent),addEvent(document,"keyup",this.keyupEvent),addEvent(document,"keypress",this.keydownEvent)},begin:function(){this.addPlayer(),this.sessionManager.isPlaying=!0,GameGlobals.useAnimationFrame||(this.loopTimer=window.setInterval(bind(this,this.loop),1e3/GameGlobals.FPS)),GameGlobals.useAnimationFrame&&requestAnimFrame(bind(this,this.loop))},keydown:function(t){var e=code(t.keyCode);switch(this.keyMap[e]=!0,e){case"left":case"right":case"up":case"down":case"esc":case" ":stopEvent(t)}switch(e){case"esc":this.destroy()}},keyup:function(t){var e=code(t.keyCode);switch(this.keyMap[e]=!1,e){case"left":case"right":case"up":case"down":case"esc":case" ":t.stopPropogation&&t.stopPropogation(),t.preventDefault&&t.preventDefault(),t.returnValue=!1}},loop:function(){var t=now(),e=(t-this.lastUpdate)/1e3;this.updateWindowInfo();for(var i,s=0;i=this.players[s];s++)i.update(e);this.bulletManager.update(e),this.bombManager.update(e),this.explosionManager.update(e),this.ui.update(e),this.statisticsManager&&this.statisticsManager.update(e),this.sessionManager.update(e),this.lastUpdate=t,GameGlobals.useAnimationFrame&&requestAnimFrame(bind(this,this.loop))},addPlayer:function(){var t=Ships.Standard;window.KICKASSSHIP&&window.KICKASSSHIP.points&&(t=KICKASSSHIP),this.mySite&&this.mySite.getShipConfig()&&(t=this.mySite.getShipConfig());var e=new Player(this);e.setShip(t),this.players.push(e),this.explosionManager.addExplosion(e.pos)},registerElement:function(t){if(!t)throw new Error("Can't register unexisting element.");this.elements.push(t)},unregisterElement:function(t){this.elements.splice(this.elements.indexOf(t),1)},isKickAssElement:function(t){for(var e,i=0;e=this.elements[i];i++)if(t===e||elementIsContainedIn(e,t))return!0;return!1},isKeyPressed:function(t){return!!this.keyMap[t]},updateWindowInfo:function(){var t=!!window.ActiveXObject&&"BackCompat"==document.compatMode;this.windowSize={width:document.documentElement.clientWidth,height:document.documentElement.clientHeight},t&&(this.windowSize.width=document.body.clientWidth,this.windowSize.height=document.body.clientHeight),this.menuManager&&this.menuManager.isVisible()&&(this.windowSize.height-=this.menuManager.getHeight()),this.scrollPos.x=window.pageXOffset||document.documentElement.scrollLeft,this.scrollPos.y=window.pageYOffset||document.documentElement.scrollTop,this.scrollSize=getScrollSize()},hideAll:function(){for(var t,e=0;t=this.elements[e];e++)t.style.visibility="hidden"},showAll:function(){for(var t,e=0;t=this.elements[e];e++)t.style.visibility="visible"},updateShips:function(t,e){e||this.ui.showMessage("You're now flying<br /><em>"+t.name+"<em>!!");for(var i,s=0;i=this.players[s];s++)i.setShip(t)},changeWeapon:function(t,e){this.weaponClass=t.cannonClass,e||this.ui.showMessage("Changed to "+t.name.toUpperCase()+"!!!!");for(var i,s=0;i=this.players[s];s++)i.setCannons(t.cannonClass)},changeWeaponById:function(t,e){Weapons[t]&&this.changeWeapon(Weapons[t],e)},flyOutPlayers:function(t,e){for(var i,s=0;i=this.players[s];s++)i.flyTo(t,-i.size.height),i.isBound=!1},flyInPlayers:function(){for(var t,e=0;t=this.players[e];e++)t.flyTo(t.pos.x,100,function(){this.isBound=!0})},newRank:function(t){this.ui.showMessage("OMG. You leveled up to: <strong>"+t+"</strong>!<br /><small>Be sure to check what cool new stuff you get in the menu.</small>")},fireBomb:function(){this.bombManager.blow()},destroy:function(){removeEvent(document,"keydown",this.keydownEvent),removeEvent(document,"keypress",this.keydownEvent),removeEvent(document,"keyup",this.keyupEvent);for(var t,e=0;t=this.players[e];e++)t.destroy();this.bulletManager.destroy(),this.explosionManager.destroy(),this.menuManager.destroy(),GameGlobals.useAnimationFrame||clearInterval(this.loopTimer),getGlobalNamespace().KICKASSGAME=!1,this.isCampaign()&&document.location.reload()},isCampaign:function(){return getGlobalNamespace().IS_CLOUDFLARE_GAME},isMySite:function(){return!!getGlobalNamespace().KICKASS_SITE_KEY},shouldShowAd:function(){return!this.mySite&&!this.isCampaign()},shouldShowMenu:function(){return!this.mySite&&!this.isCampaign()},shouldShowHowToImage:function(){return this.mySite||this.isCampaign()}});window.KickAss=KickAss;var StatisticsManager=new Class({initialize:function(t){this.game=t,this.data={},this.data.startedPlaying=now(),this.data.elementsDestroyed=0,this.data.shotsFired=0,this.data.distanceFlownInPixels=0,this.data.totalPointsThisSession=0,this.data.usedThrusters=0,this.lastUpdate=0},usedThrusters:function(){this.data.usedThrusters=1},increaseDistanceWithPixels:function(t){this.data.distanceFlownInPixels+=t},increasePointsGainedWithPoints:function(t){this.data.totalPointsThisSession+=t},addShotFired:function(){this.data.shotsFired++,this.game.audioManager.shot&&this.game.audioManager.shot.play()},addElementsDestroyed:function(){this.data.elementsDestroyed++},update:function(t){this.lastUpdate+=t,this.lastUpdate>.25&&(this.syncWithServer(),this.lastUpdate=0)},syncWithServer:function(){var t=[];for(var e in this.data)this.data.hasOwnProperty(e)&&t.push(e+":"+this.data[e]);this.game.menuManager.sendMessageToMenu("stats:!"+t.join("|"))}}),MySite=new Class({initialize:function(t){this.key=t},load:function(t){CORS.request(GameGlobals.path("mysite/api.json"),{site_key:this.key,url:document.location.toString()},bind(this,function(e){e&&e.embed?(this.mySiteData=e.embed,t(!0)):t(!1)}))},install:function(){},getShipId:function(){return this.mySiteData&&this.mySiteData.settings.ship},getShipConfig:function(){return this.mySiteData&&this.mySiteData.settings.ship_config},getShareURL:function(){return this.mySiteData&&this.mySiteData.settings.share_url}}),Menu=new Class({initialize:function(t){this.game=t,this.size={height:300}},function(t){this.container=document.createElement("div"),this.container.className="KICKASSELEMENT",this.container.id="kickass-profile-menu",t.appendChild(this.container);var e=getGlobalNamespace().KICKASSSHIPID||"";this.url=GameGlobals.path("intermediate_postmessage.html?url="+encodeURIComponent(getGlobalNamespace().KICKASSURL||document.location.href)+"&origin="+encodeURIComponent(document.location.href)+"&preship="+e+"&is_campaign="+(this.game.isCampaign()?"true":"")+"&is_mysite="+(this.game.isMySite()?"true":"")),this.isSocketReady=!1,window.addEventListener("message",this.onMessage,!1),this.game.registerElement(this.container)},socketPostMessage:function(t){this.socketIframe.contentWindow.postMessage(t,this.menuOrigin)},onGameReady:function(){this.isSocketReady=!0,this.game.registerElement(this.container.getElementsByTagName("iframe")[0]),this.socketPostMessage("url:!"+(getGlobalNamespace().KICKASSURL||document.location.href)),this.game.statisticsManager&&this.game.statisticsManager.syncWithServer(),this.game.menuManager.onGameReady()},sendMessage:function(t){if(this.isSocketReady&&t!=this.lastMessage){try{this.socketPostMessage(t)}catch(t){}this.lastMessage=t}},messageTypeChangeShip:function(t){var e=(t=t.split(","))[0],i=(t[1],"initial"===t[2]);this.shipId!==e&&(i&&getGlobalNamespace().KICKASSSHIP||(this.shipId=e,CORS.request(GameGlobals.path("designer/ship/"+e+"/construction.json"),{ship_id:e,is_initial:i?"1":"0"},bind(this,function(t){this.game.updateShips(t.data,i);try{window.focus()}catch(t){}})),i||this.parent.hideMenu()))},messageTypeChangeWeapon:function(t,e){this.game.changeWeaponById(t,e)},messageTypeSetMultiplier:function(t){t=parseInt(t,10),!isNaN(t)&&t&&(this.game.multiplier=t)},messageTypeNewRank:function(t){this.game.newRank(t)},messageTypePlayerMessage:function(t){this.game.ui.showMessage(t)},destroy:function(){this.game.unregisterElement(this.container),this.game.unregisterElement(this.iframe),window.removeEventListener("message",this.onMessage,!1),this.container.parentNode.removeChild(this.container)}}),MenuManager=new Class({initialize:function(t){this.game=t,this.numPoints=0,getGlobalNamespace().KICKASS_INLINE_CSS},generateDefaults:function(){for(var t in Weapons)Weapons.hasOwnProperty(t)&&this.addWeapon(Weapons[t],t);this.hideBombMenu()},create:function(){this.container=document.createElement("div"),this.container.className="KICKASSELEMENT KICKASShidden "+(this.game.shouldShowMenu()?"":"KICKASSNOMENU"),this.container.id="kickass-menu",this.game.shouldShowMenu()?(this.container.style.bottom="-250px",this.container.style.display="none"):removeClass(this.container,"KICKASShidden"),getAppContainerElement().appendChild(this.container);var t=(this.game.shouldShowAd(),"");this.container.innerHTML='<div id="kickass-howto-image" class="KICKASSELEMENT kickass-howto-invisible"></div><div id="kickass-pointstab" class="KICKASSELEMENT">'+t+'<div id="kickass-bomb-menu" class="KICKASSELEMENT KICKASShidden"><ul id="kickass-bomb-list" class="KICKASSELEMENT"></ul></div><div id="kickass-weapons-menu" class="KICKASSELEMENT KICKASShidden" style="display:none"><ul id="kickass-weapons-list" class="KICKASSELEMENT"></ul></div><div id="kickass-pointstab-wrapper" class="KICKASSELEMENT"><div id="kickass-points" class="KICKASSELEMENT">'+this.numPoints+'</div><div id="kickass-esctoquit" class="KICKASSELEMENT">Paina esciä poistuaksesi</div>'+this.getShareHTML()+'</div><ul id="kickass-pointstab-menu" class="KICKASSELEMENT" '+(this.game.shouldShowMenu()?"":'style="display:none"')+"></ul></div>",this.pointsTab=document.getElementById("kickass-pointstab"),this.pointsTabWrapper=document.getElementById("kickass-pointstab-wrapper"),this.points=document.getElementById("kickass-points"),this.escToQuit=document.getElementById("kickass-esctoquit"),this.howToImage=document.getElementById("kickass-howto-image"),this.weaponsMenu=document.getElementById("kickass-weapons-menu"),this.weaponsList=document.getElementById("kickass-weapons-list"),this.bombLink=document.getElementById("kickass-bomb-menu");for(var e=this.container.getElementsByTagName("*"),i=0;i<e.length;i++)this.game.registerElement(e[i]);this.game.registerElement(this.container),this.game.shouldShowMenu()||setTimeout(function(){this.onGameReady()}.bind(this),100),addEvent(this.bombLink,"click",bind(this,function(t){stopEvent(t),this.game.fireBomb()})),addEvent(this.pointsTabWrapper,"click",bind(this,this.toggleMenu)),addEvent(this.weaponsMenu,"click",bind(this,this.toggleWeaponsMenu)),this.generateDefaults()},getShareHTML:function(){if(void 0!==getGlobalNamespace().KICKASS_SHARE_URL){if(getGlobalNamespace().KICKASS_SHARE_URL){encodeURIComponent(getGlobalNamespace().KICKASS_SHARE_URL);return""}return""}if(this.game.mySite){if(!this.game.mySite.getShareURL())return"";this.game.mySite.getShareURL()}return""},onGameReady:function(){this.container.style.display="block",this.game.shouldShowHowToImage()&&(setTimeout(bind(this,function(){removeClass(this.howToImage,"kickass-howto-invisible")}),10),setTimeout(bind(this,function(){addClass(this.howToImage,"kickass-howto-invisible")}),4e3))},navigateTo:function(t,e){e||this.showMenu(),this.menu&&this.menu.socketPostMessage("navigate:!"+t)},toggleMenu:function(){this.game.shouldShowMenu()?hasClass(this.container,"KICKASShidden")?this.showMenu():this.hideMenu():this.showMenu()},toggleWeaponsMenu:function(){hasClass(this.weaponsMenu,"KICKASShidden")?this.showWeaponsMenu():this.hideWeaponsMenu()},hideWeaponsMenu:function(){this.weaponsMenu.style.width="",addClass(this.weaponsMenu,"KICKASShidden")},showWeaponsMenu:function(){var t=this.weaponsMenu.getElementsByTagName("li");t=t[t.length-1],this.weaponsMenu.style.width=t.offsetLeft+t.offsetWidth-47+"px",removeClass(this.weaponsMenu,"KICKASShidden")},showMenu:function(){this.game.shouldShowMenu()&&(this.container.style.bottom="",removeClass(this.container,"KICKASShidden"))},hideMenu:function(){this.container.style.bottom="",addClass(this.container,"KICKASShidden")},showBombMenu:function(){this.bombLink.style.width=""},hideBombMenu:function(){this.bombLink.style.width="0px"},getHeight:function(){return this.container.clientHeight},isVisible:function(){return!hasClass(this.container,"KICKASShidden")},addPoints:function(t,e){var i=t*this.game.multiplier;this.numPoints+=i,this.points.innerHTML=this.numPoints,this.game.statisticsManager&&this.game.statisticsManager.increasePointsGainedWithPoints(i),this.game.ui.addPointsBubbleAt(e,i)},includeCSS:function(t){var e=document.createElement("link");e.rel="stylesheet",e.type="text/css",e.href=t,(document.head||document.body).appendChild(e)},sendMessageToMenu:function(t){this.menu&&this.menu.sendMessage(t)},addWeapon:function(t,e){var i=document.createElement("li");i.className="KICKASSELEMENT kickass-weapon-item",i.weapon=t,i.style.backgroundImage="url("+GameGlobals.path("css/gfx/kickass/weap-"+t.id+".png")+")",i.innerHTML='<span class="KICKASSELEMENT">'+t.name+"</span>",this.weaponsList.appendChild(i),addEvent(i,"click",bind(this,function(i){stopEvent(i),this.changeWeapon(t),this.sendMessageToMenu("changeWeapon:!"+e)}))},changeWeapon:function(t){this.game.changeWeapon(t)},destroy:function(){for(var t=this.container.getElementsByTagName("*"),e=0;e<t.length;e++)this.game.unregisterElement(t[e]);this.game.unregisterElement(this.container),this.menu&&this.menu.destroy(),this.container.parentNode.removeChild(this.container)}}),UIManager=new Class({initialize:function(t){this.UNIQID=0,this.game=t,this.pointBubbles={},this.messages={},this.fx=new Fx,this.fx.addListener(this)},update:function(t){this.fx.update()},set:function(t,e,i){var s=t.split("-")[0],n=t.split("-")[1];if(this.pointBubbles[n]){var o=this.pointBubbles[n];o.style.top=e[0]+"px",o.style.opacity=e[1],1==i&&o.parentNode&&(o.parentNode.removeChild(o),delete this.pointBubbles[n])}else if(this.messages[n]&&"messagedown"==s){(a=this.messages[n]).style.top=e[0]+"px",1==i&&setTimeout(bind(this,function(){this.fx.add("messageup-"+n,{tweens:[[e[0],-100]],transition:Tween.Quadratic,duration:300})}),a.staytime||4e3)}else if(this.messages[n]&&"messageup"==s){var a;(a=this.messages[n]).style.top=e[0]+"px",1==i&&(a.parentNode.removeChild(a),delete this.messages[n])}},addPointsBubbleAt:function(t,e){var i="bubble"+this.UNIQID++,s=this.game.scrollPos.y+t.y,n=newElement("span",{innerHTML:e,className:"KICKASSELEMENT",styles:{position:"absolute",font:"18px Circular",fontWeight:"bold",opacity:"1",color:"#4d4aff",textShadow:"#fff 1px 1px 3px",top:s,zIndex:"10000000"}});n.style.left=t.x-n.offsetWidth/2+"px",getAppContainerElement().appendChild(n),this.pointBubbles[i]=n,this.fx.add("bubble-"+i,{tweens:[[s,s-15],[1,0]]})},showMessage:function(t,e){e=e||!1;var i=this.UNIQID++,s=newElement("div",{innerHTML:t,className:"KICKASSELEMENT",id:"kickass-message-"+i,styles:{position:"fixed",top:-100,left:"50%",marginLeft:-150,width:300,background:"#4d4aff",opacity:.8,padding:"10px",color:"#fff",textAlign:"center",borderRadius:15,font:"18px Circular",fontWeight:"bold",zIndex:"10000000"}});s.staytime=e,getAppContainerElement().appendChild(s);var n=this.getLowestBubbleY();return s.kickassto=n,this.fx.add("messagedown-"+i,{duration:300,tweens:[[-100,n]],transition:Tween.Quadratic}),this.messages[i]=s,s},getLowestBubbleY:function(){var t=100;for(var e in this.messages)this.messages.hasOwnProperty(e)&&(t=Math.max(this.messages[e].kickassto+this.messages[e].offsetHeight+10,t));return t}}),AudioManager=new Class({initialize:function(t,e){if(this.src=t,this.formats=e,channels=8,this.supportsAudio=void 0!==document.createElement("audio").play,this.supportsAudio){this.numChannels=channels,this.channels=[];for(var i=0;i<this.numChannels;i++)this.channels.push({isPlaying:!1,element:this.prepareElement(this.buildAudioElement())})}},buildAudioElement:function(){for(var t,e={ogg:"audio/ogg",mp3:"audio/mpeg"},i=document.createElement("audio"),s=0;t=this.formats[s];s++){var n=document.createElement("source");n.src=this.src+"."+t,n.type=e[t],i.appendChild(n)}return i},prepareElement:function(t){if(void 0===t.addEventListener)return t;var e=this;return t.addEventListener("ended",function(i){e.audioEnded(t)},!1),t},audioEnded:function(t){for(var e,i=0;e=this.channels[i];i++)e.element===t&&(e.isPlaying=!1)},play:function(){if(this.supportsAudio)for(var t,e=0;t=this.channels[e];e++)if(!t.isPlaying)return t.isPlaying=!0,void("function"==typeof t.element.play&&t.element.play())}}),Ships={Standard:{points:[[-10,10],[0,-15],[10,10]],thrusters:[{s:{w:20,h:7},p:{x:0,y:14},a:0}],cannons:[{p:{x:0,y:-15},a:0}]}},PLAYERIDS=0,Player=new Class({initialize:function(t){this.id=PLAYERIDS++,this.game=t,this.tween=!1,this.isBound=!0,this.pos=new Vector(200,200),this.vel=new Vector(0,0),this.acc=new Vector(0,0),this.dir=new Vector(0,1),this.currentRotation=0,this.isBroken=!1,this.lineOffsets=[],this.deadTime=0,this.friction=.8,this.terminalVelocity=2e3,this.lastPos=new Vector(0,0)},setShip:function(t){this.ship=t,this.verts=[];for(var e,i=0;e=this.ship.points[i];i++)this.verts.push(new Vector(e[0],e[1]));this.verts.push(this.verts[0]),this.thrusters=[],this.cannons=[],this.addThrusters(this.ship.thrusters),this.addCannons(this.ship.cannons),this.size=this.getSizeFromVertsAndObjects(),this.bounds=this.calculateBounds(),this.sheet&&this.sheet.destroy(),this.sheet=new Sheet(new Rect(100,100,this.bounds.x,this.bounds.y)),this.forceRedraw=!0},setCannons:function(t){for(var e,i=[],s=0;e=this.cannons[s];s++){var n=new t(this,this.game,e.pos.x,e.pos.y,e.angle);i.push(n),e.destroy()}this.cannons=i},addThrusters:function(t){for(var e,i=0;e=t[i];i++){var s=new Thruster(e);this.thrusters.push(s)}},addCannons:function(t){for(var e,i=0;e=t[i];i++){var s=new(WeaponMap[e.m]||WeaponMap.cannon).cannonClass(this,this.game,e.p.x,e.p.y,e.a);s.player=this,s.game=this.game,this.cannons.push(s)}},update:function(t){if(this.isBroken){if(!this.lineOffsets.length)for(var e=0;e<this.verts.length-1;e++)this.lineOffsets[e]={pos:new Vector(0,0),dir:new Vector(1,1).setAngle(2*Math.PI*Math.random())};for(e=0;e<this.lineOffsets.length;e++)this.lineOffsets[e].pos.add(this.lineOffsets[e].dir.cp().setLength(50).mul(t));return this.sheet.clear(),this.sheet.setAngle(this.dir.angle()),this.sheet.setPosition(this.pos),this.sheet.drawBrokenPlayer(this.verts,this.lineOffsets),void(now()-this.deadTime>1e3&&(this.isBroken=!1,this.lineOffsets=[],this.randomPos()))}this.tween||(this.game.isKeyPressed("left")||this.game.isKeyPressed("right")?(this.game.isKeyPressed("left")&&this.rotateLeft(t),this.game.isKeyPressed("right")&&this.rotateRight(t)):this.stopRotate(),this.game.isKeyPressed("up")?this.activateThrusters():this.stopThrusters()),this.game.isKeyPressed(" ")?(this.isShooting=!0,this.isBroken||this.shootPressed()):this.isShooting&&(this.isShooting=!1,this.shootReleased()),this.currentRotation&&this.dir.setAngle(this.dir.angle()+this.currentRotation*t);var i=this.acc.mulNew(t).sub(this.vel.mulNew(t*this.friction));this.vel.add(i),this.vel.len()>this.terminalVelocity&&this.vel.setLength(this.terminalVelocity);var s=this.vel.mulNew(t);this.pos.add(s),this.game.statisticsManager&&this.game.statisticsManager.increaseDistanceWithPixels(s.len());var n=!this.acc.is({x:0,y:0});for(e=0;o=this.thrusters[e];e++)o.setIsShown(n),o.update(t);if(this.isBound&&this.checkBounds(),!this.lastPos.is(this.pos)||this.currentRotation||this.forceRedraw){if(this.forceRedraw=!1,this.sheet.clear(),this.sheet.setAngle(this.dir.angle()+Math.PI/2),this.sheet.setPosition(this.pos),n){var o;for(e=0;o=this.thrusters[e];e++)o.drawTo(this.sheet)}this.sheet.drawPlayer(this.verts),this.lastPos=this.pos.cp()}var a;for(e=0;a=this.cannons[e];e++)a.update(t)},randomPos:function(){var t=this.game.windowSize.width,e=this.game.windowSize.height;this.pos=new Vector(random(0,t),random(0,e))},checkBounds:function(){if(!this.tween){var t=this.game.windowSize.width,e=this.game.windowSize.height,i=this.pos.x+this.sheet.rect.size.width/2,s=this.pos.y+this.sheet.rect.size.height/2;i>t?(window.scrollTo(this.game.scrollPos.x+50,this.game.scrollPos.y),this.pos.x=0):this.pos.x<0&&(window.scrollTo(this.game.scrollPos.x-50,this.game.scrollPos.y),this.pos.x=t-this.sheet.rect.size.width/2),s>e?(window.scrollTo(this.game.scrollPos.x,this.game.scrollPos.y+.75*e),this.pos.y=0):this.pos.y<0&&(window.scrollTo(this.game.scrollPos.x,this.game.scrollPos.y-.75*e),this.pos.y=e-this.sheet.rect.size.height/2)}},inRect:function(t){for(var e,i=!1,s=0;e=this.verts[s];s++)t.hasPoint(new Vector(e.x+this.pos.x,e.y+this.pos.y))&&(i=!0);return i},hit:function(t){this.isBroken||(this.isBroken=!0,this.deadTime=now())},activateThrusters:function(){this.game.statisticsManager&&this.game.statisticsManager.usedThrusters(),this.acc=new Vector(500,0).setAngle(this.dir.angle())},stopThrusters:function(){this.acc=new Vector(0,0)},rotateLeft:function(t){this.currentRotation=Math.max(2*-Math.PI,this.currentRotation-10*Math.PI*t)},rotateRight:function(t){this.currentRotation=Math.min(2*Math.PI,this.currentRotation+10*Math.PI*t)},stopRotate:function(){this.currentRotation=0},getSizeFromVertsAndObjects:function(){for(var t,e=0,i=0;t=this.verts[i];i++)e=Math.max(e,new Vector(t).len());var s;for(i=0;s=this.thrusters[i];i++){var n=new Vector(s.pos.x-s.size.width/2,s.pos.y-s.size.height/2).rotate(s.angle),o=new Vector(s.pos.x+s.size.width/2,s.pos.y-s.size.height/2).rotate(s.angle),a=new Vector(s.pos.x-s.size.width/2,s.pos.y+s.size.height/2).rotate(s.angle),r=new Vector(s.pos.x+s.size.width/2,s.pos.y+s.size.height/2).rotate(s.angle);e=Math.max(e,n.len(),o.len(),a.len(),r.len())}return{width:2*e,height:2*e}},calculateBounds:function(){return{x:1*Math.max(this.size.width,this.size.height),y:1*Math.max(this.size.height,this.size.width)}},shootPressed:function(){for(var t,e=0;t=this.cannons[e];e++)t.shootPressed()},shootReleased:function(){for(var t,e=0;t=this.cannons[e];e++)t.shootReleased()},flyTo:function(t,e,i){this.tween={start:{pos:this.pos.cp(),dir:this.dir.cp()},to:new Vector(t,e),callback:i||function(){}},this.tween.time=this.getTimeforTween()},destroy:function(){this.sheet.destroy()}}),Thruster=new Class({initialize:function(t,e){this.pos=new Vector(t.p),this.size={width:t.s.w,height:t.s.h},this.angle=t.a||0,this.ship=e,this.isShown=!1,this.flameY=1,this.fx=new Fx,this.fx.addListener(this),this.flames={r:[],y:[]},this.lastFrameUpdate=0,this.generateFlames()},update:function(t){this.fx.update(),now()-this.lastFrameUpdate>1e3/60&&this.generateFlames()},set:function(t,e){switch(t){case"flames":this.flameY=e}},setIsShown:function(t){!this.isShown&&t&&(this.flameY=0,this.generateFlames(),this.fx.add("flames",{start:this.flameY,end:1,duration:250,transition:Tween.Quintic})),this.isShown=t},drawTo:function(t){t.drawFlames(this.flames,this.angle)},generateFlames:function(){var t=this.size.width,e=.05*this.size.width,i=.8*this.size.width,s=.1*i,n=t/2,o=i/2,a=(this.size.height,this.pos.x),r=this.pos.y-this.size.height/2;function l(t,e){return new Vector(t,e)}this.flames.r=[l(-n+a,r)],this.flames.y=[l(-o+a,r)],this.flames.self=this;for(var h=0;h<t;h+=e)this.flames.r.push(l(h-n+a,this.flameY*random(.7*this.size.height,this.size.height)+r));this.flames.r.push(l(n+a,r));for(h=0;h<i;h+=s)this.flames.y.push(l(h-o+a,this.flameY*random(.4*this.size.height,.7*this.size.height)+r));this.flames.y.push(l(o+a,r)),this.lastFrameUpdate=now();for(var c=l(a,r),d=0;u=this.flames.r[d];d++)u.sub(c).rotate(this.angle).add(c);var u;for(d=0;u=this.flames.y[d];d++)u.sub(c).rotate(this.angle).add(c)}}),BombManager=new Class({initialize:function(t){this.game=t,this.bombShowDelay=30,this.nextBomb=this.bombShowDelay},update:function(t){this.game.isKeyPressed("F")&&this.isReady()&&this.blow(),-1!==this.nextBomb&&this.game.sessionManager.isPlaying&&(this.nextBomb-=t,this.nextBomb<0&&(this.game.menuManager.showBombMenu(),this.nextBomb=-1,this.game.ui.showMessage("Pommi on valmis!<br />(paina F)")))},blow:function(){var t=this.game.ui.showMessage("3...",5e3);delay(1e3,function(){t.innerHTML="2..."},this),delay(2e3,function(){t.innerHTML="1..."},this),delay(3e3,function(){t.innerHTML="boom"},this),delay(3e3,this.blowStuffUp,this),this.nextBomb=this.bombShowDelay},blowStuffUp:function(){this.game.bulletManager.updateEnemyIndex();for(var t,e=this.game.bulletManager.enemyIndex,i=0;(t=e[i])&&i<10;i++){var s=getRect(t),n=new Vector(s.left+s.width/2,s.top+s.height/2);this.game.explosionManager.addExplosion(n,t,MegaParticleExplosion),t.parentNode.removeChild(t)}this.game.menuManager.hideBombMenu(),this.nextBomb=this.bombShowDelay},isReady:function(){return-1===this.nextBomb}}),ELEMENTSTHATARENOTTOBEINCLUDED=["BR","SCRIPT","STYLE","TITLE","META","HEAD","OPTION","OPTGROUP","LINK"],ELEMENTSIZETHRESHOLD=5,BulletManager=new Class({initialize:function(t){this.game=t,this.lastBlink=0,this.blinkActive=!1,this.enemyIndex=[],this.updateDelay=2.5,this.nextUpdate=this.updateDelay},update:function(t){this.game.isKeyPressed("B")?this.blink():this.blinkActive&&this.endBlink(),this.nextUpdate-=t,this.nextUpdate<0&&this.updateEnemyIndex()},blink:function(){if(now()-this.lastBlink>250){for(var t,e=0;t=this.enemyIndex[e];e++)this.blinkActive?t.style.outline=t.KICKASSOLDBORDER:t.style.outline="1px solid red";this.blinkActive=!this.blinkActive,this.lastBlink=now(),this.blinkActive||this.updateEnemyIndex()}},endBlink:function(){for(var t,e=0;t=this.enemyIndex[e];e++)t.style.outline=t.KICKASSOLDBORDER;this.lastBlink=0,this.blinkActive=!1},updateEnemyIndex:function(){var t=document.getElementsByTagName("*");this.enemyIndex=[];for(var e,i=0;e=t[i];i++)this.isDestroyable(e)&&(this.enemyIndex.push(e),e.KICKASSOLDBORDER=e.style.outline||document.defaultView.getComputedStyle(e,null).outline);this.nextUpdate=this.updateDelay},isDestroyable:function(t,e){if(this.shouldIgnoreElement(t,e))return!1;for(var i,s=0;i=t.childNodes[s];s++)if(1===i.nodeType&&-1===ELEMENTSTHATARENOTTOBEINCLUDED.indexOf(i.tagName)&&i.offsetWidth>=ELEMENTSIZETHRESHOLD&&i.offsetHeight>=ELEMENTSIZETHRESHOLD&&"hidden"!==document.defaultView.getComputedStyle(i,null).visibility)return!1;return!0},isDestroyableFromCollision:function(t){return this.isDestroyable(t,!0)},shouldIgnoreElement:function(t,e){return 1!==t.nodeType||(t==document.documentElement||t==document.body||(-1!==ELEMENTSTHATARENOTTOBEINCLUDED.indexOf(t.tagName)||("hidden"==t.style.visibility||"none"==t.style.display||("string"==typeof t.className&&-1!=t.className.indexOf("KICKASSELEMENT")||(!e&&(t.offsetWidth<ELEMENTSIZETHRESHOLD||t.offsetHeight<ELEMENTSIZETHRESHOLD)||((t.offsetLeft<0||t.offsetTop<0)&&((i=getRect(t)).left+i.width<0||i.top+i.height<0)||(i||(i=getRect(t)),i.top>=this.game.scrollSize.y)))))));var i},destroy:function(){for(var t in this.bullets)if(this.bullets.hasOwnProperty(t))for(var e,i=0;e=this.bullets[t][i];i++)e.destroy();this.bullets={}}}),SessionManager=new Class({initialize:function(t){this.game=t,this.isPlaying=!1},update:function(t){this.isPlaying&&0==this.game.bulletManager.enemyIndex.length&&this.weHaveWon()},weHaveWon:function(){this.isPlaying=!1,this.game.ui.showMessage("You're done!"),this.game.isCampaign()?(this.game.menuManager.showMenu(),this.game.menuManager.navigateTo("highscores")):this.game.menuManager.showMenu(),this.game.menuManager.sendMessageToMenu("gameFinished:!")}}),ExplosionManager=new Class({initialize:function(t){this.game=t,this.explosions=[]},update:function(t){for(var e,i=now(),s=0;e=this.explosions[s];s++)i-e.bornAt>(e.ttl||500)?(e.destroy(),this.explosions.splice(s,1)):e.update(t)},addExplosion:function(t,e,i){var s=new(i=i||ParticleExplosion)(t,e);s.game=this.game,s.checkBounds(),this.explosions.push(s),this.game.audioManager.explosion&&this.game.audioManager.explosion.play()},destroy:function(){for(var t,e=0;t=this.explosions[e];e++)t.destroy();this.explosions=[]}}),Cannon=new Class({initialize:function(t,e,i,s,n){this.player=t,this.game=e,this.pos=new Vector(i,s),this.angle=n||0},shootPressed:function(){},shootReleased:function(){},checkCollisions:function(){},getExplosionClass:function(){return ParticleExplosion},update:function(t){this.game.hideAll(),this.checkCollisions(t),this.game.showAll()},checkCollision:function(t){var e=t.checkCollision();return!!e&&(this.game.explosionManager.addExplosion(t.pos,e,this.getExplosionClass()),this.game.menuManager.addPoints(Math.min(e.getElementsByTagName("*").length+1,100),t.pos),e.isShot||e.parentNode.removeChild(e),this.game.statisticsManager&&this.game.statisticsManager.addElementsDestroyed(),!0)},createBullet:function(t){var e=new t(this.getABulletPos(),this.getABulletDir());return e.game=this.game,e.manager=this,e.initCanvas(),e.vel.add(e.vel.cp().setLength(this.player.vel.len())),e},getABulletPos:function(){return this.player.pos.cp().add(this.pos.cp().rotate(this.player.dir.angle()+Math.PI/2))},getABulletDir:function(){return this.player.dir.cp().rotate(this.angle)},destroy:function(){}}),LaserCannon=new Class({Extends:Cannon,initialize:function(t,e,i,s,n){Cannon.prototype.initialize.apply(this,arguments),this.lasers=[]},getExplosionClass:function(){return SplitExplosion},update:function(t){this.lasers.length&&(this.removeOld(),Cannon.prototype.update.call(this,t))},checkCollisions:function(t){for(var e,i=0;e=this.lasers[i];i++)e.update(t),this.checkCollision(e)},removeOld:function(){for(var t,e=0;t=this.lasers[e];e++)t.outOfBounds&&(t.destroy(),this.lasers.splice(e,1))},shootPressed:function(){this.lasers.length>5||now()-this.lastFired<500||(this.lastFired=now(),this.game.statisticsManager&&this.game.statisticsManager.addShotFired(),this.lasers.push(this.createBullet(LaserBullet)))},destroy:function(){if(this.lasers.length){for(var t,e=0;t=this.lasers[e];e++)t.destroy();this.lasers=[]}}}),BallCannon=new Class({Extends:Cannon,initialize:function(){Cannon.prototype.initialize.apply(this,arguments),this.lastFired=0,this.bullets=[]},getExplosionClass:function(){return ParticleExplosion},update:function(t){this.bullets.length&&(this.removeOld(),Cannon.prototype.update.call(this,t))},removeOld:function(){for(var t,e=now(),i=0;t=this.bullets[i];i++)e-t.bornAt>2e3&&(t.destroy(),this.bullets.splice(i,1))},checkCollisions:function(t){for(var e,i=0;e=this.bullets[i];i++)e.update(t),this.checkCollision(e)&&(e.destroy(),this.bullets.splice(i,1))},shootPressed:function(){now()-this.lastFired<200||(this.lastFired=now(),this.addBullet(),this.game.statisticsManager&&this.game.statisticsManager.addShotFired())},addBullet:function(){this.bullets.length>7&&(this.bullets[0].destroy(),this.bullets.shift());var t=this.createBullet(Bullet);this.bullets.push(t)},destroy:function(){for(var t,e=0;t=this.bullets[e];e++)t.destroy();this.bullets=[]}}),Bullet=new Class({initialize:function(t,e){this.pos=t.cp(),this.dir=e,this.vel=new Vector(500,500),this.bornAt=now()},initCanvas:function(){this.sheet=new Sheet(new Rect(this.pos.x,this.pos.y,5,5)),this.sheet.drawBullet()},draw:function(){this.sheet.setPosition(this.pos)},update:function(t){this.pos.add(this.vel.setAngle(this.dir.angle()).mulNew(t)),this.checkBounds(),this.draw()},checkCollision:function(){var t=document.elementFromPoint(this.pos.x,this.pos.y);return t&&3==t.nodeType&&(t=t.parentNode),!(!t||!this.game.bulletManager.isDestroyableFromCollision(t))&&t},checkBounds:function(){var t=this.game.windowSize.width,e=this.game.windowSize.height,i=this.pos.x+this.sheet.rect.size.width/2,s=this.pos.y+this.sheet.rect.size.height/2;i>t?this.pos.x=0:this.pos.x<0&&(this.pos.x=t-this.sheet.rect.size.width/2),s>e?this.pos.y=0:this.pos.y<0&&(this.pos.y=e-this.sheet.rect.size.height/2)},destroy:function(){this.sheet.destroy()}}),LaserBullet=new Class({Extends:Bullet,initialize:function(){Bullet.prototype.initialize.apply(this,arguments),this.vel=new Vector(750,750),this.lastDrawPos=this.pos.cp()},initCanvas:function(){var t=Math.max(GameGlobals.laserImage.width,GameGlobals.laserImage.height);this.sheet=new Sheet(new Rect(0,0,t,t))},update:function(t){Bullet.prototype.update.apply(this,arguments)},draw:function(){this.sheet.drawLaser(this.pos,this.dir),this.lastDrawPos=this.pos.cp()},checkBounds:function(){var t=this.game.windowSize.width,e=this.game.windowSize.height,i=this.pos.x+this.sheet.rect.size.width/2,s=this.pos.y+this.sheet.rect.size.height/2;(i>t||this.pos.x<0)&&(this.outOfBounds=!0),(s>e||this.pos.y<0)&&(this.outOfBounds=!0)},destroy:function(){this.sheet.destroy()}});GameGlobals.laserImage=document.createElement("img"),GameGlobals.laserImage.src=GameGlobals.path("css/gfx/kickass/laser.png");var Explosion=new Class({initialize:function(t,e){this.bornAt=now(),this.pos=t.cp()},update:function(t){},checkBounds:function(){},destroy:function(){}}),ParticleExplosion=new Class({Extends:Explosion,initialize:function(t,e){Explosion.prototype.initialize.apply(this,arguments),this.particleVel=new Vector(150,0),this.particles=[],this.generateParticles(),this.sheet=new Sheet(new Rect(t.x,t.y,250,250))},update:function(t){for(var e,i=0;e=this.particles[i];i++)e.pos.add(e.vel.mulNew(t).mul(random(.5,1)).setAngle(e.dir.angle()));this.sheet.clear(),this.sheet.drawExplosion(this.particles)},generateParticles:function(){for(var t=0,e=GameGlobals.hasCanvas?40:10;t<e;t++)this.particles.push({dir:new Vector(random(0,20)-10,random(0,20)-10).normalize(),vel:this.particleVel.cp(),pos:new Vector(0,0),color:["#ccc","#aaa"][random(0,1)]})},checkBounds:function(){var t=this.sheet.rect.getRight(),e=this.sheet.rect.getBottom(),i=this.game.windowSize.width,s=this.game.windowSize.height;t>i&&(this.pos.x-=t-i),e>s&&(this.pos.y-=e-s),this.sheet.setPosition(this.pos)},destroy:function(){this.sheet.destroy()}}),MegaParticleExplosion=new Class({Extends:ParticleExplosion,initialize:function(t,e){Explosion.prototype.initialize.apply(this,arguments),this.particleVel=new Vector(200,0),this.particles=[],this.generateParticles(),this.sheet=new Sheet(new Rect(t.x,t.y,500,500)),this.ttl=2e3,this.generationDelay=.6,this.generationTimes=2,this.nextGenerate=this.generationDelay},update:function(t){this.nextGenerate-=t,this.nextGenerate<=0&&this.generationTimes>0&&(this.nextGenerate=this.generationDelay,this.generateParticles(),this.generationTimes--),ParticleExplosion.prototype.update.call(this,t)}}),SplitExplosion=new Class({Extends:Explosion,initialize:function(t,e){e&&(Explosion.prototype.initialize.apply(this,arguments),this.element=e,this.fx=new Fx,this.fx.addListener(this),this.start())},update:function(t){this.element&&this.fx.update()},set:function(t,e){},start:function(){var t=this.createClones(),e=t[0],i=t[1],s="rotate(-"+random(30,50)+"deg) translate(-100px, 40px)",n="rotate("+random(30,50)+"deg) translate(100px, 40px)";setStyles(e,{transform:s}),setStyles(i,{transform:n}),this.left=e,this.right=i,this.fx.add("opacity",{start:1,end:.5,duration:500})},createClones:function(){var t=getRect(this.element),e=this.createContainer(t),i=this.createContainer(t),s=cloneElement(this.element),n=cloneElement(this.element);addClass(s,"KICKASSELEMENT"),addClass(n,"KICKASSELEMENT");var o={margin:0,overflow:"hidden"};return setStyles(s,o),setStyles(n,o),e.appendChild(s),i.appendChild(n),i.style.left=t.left+t.width/2+"px",i.scrollLeft+=t.width/2,this.element.style.opacity=0,this.element.style.visibility="hidden",this.element.style.display="none",each([e,i],function(t){t.style.transition="transform 500ms ease-in"})},createContainer:function(t){var e=document.createElement("div");return setStyles(e,{position:"absolute",left:t.left,top:t.top,width:.5*t.width,height:t.height,overflow:"hidden"}),getAppContainerElement().appendChild(e),e},destroy:function(){try{this.left.parentNode.removeChild(this.left),this.right.parentNode.removeChild(this.right),this.element.parentNode.removeChild(this.element)}catch(t){}}}),Weapons={1:{name:"Cannon",id:"cannon",cannonClass:BallCannon},2:{name:"Laser",id:"laser",cannonClass:LaserCannon}},WeaponMap={cannon:Weapons[1],laser:Weapons[2]},SheetCanvas=new Class({initialize:function(rect){with(this.canvas=document.createElement("canvas"),this.canvas.className="KICKASSELEMENT",this.canvas.style)position="absolute",zIndex="1000000";GameGlobals.kickass.registerElement(this.canvas),this.canvas.getContext&&(this.ctx=this.canvas.getContext("2d")),this.rect=rect,this.angle=0,this.updateCanvas(),getAppContainerElement().appendChild(this.canvas)},tracePoly:function(t){if(t[0]){this.ctx.save(),this.ctx.translate(this.rect.size.width/2,this.rect.size.height/2),this.ctx.rotate(this.angle),this.ctx.beginPath(),this.ctx.moveTo(t[0].x,t[0].y);for(var e=0;e<t.length;e++)this.ctx.lineTo(t[e].x,t[e].y);this.ctx.restore()}},setAngle:function(t){this.angle=t},updateCanvas:function(){this.canvas.width!=this.rect.size.width&&(this.canvas.width=this.rect.size.width),this.canvas.height!=this.rect.size.height&&(this.canvas.height=this.rect.size.height),this.canvas.style.left=GameGlobals.kickass.scrollPos.x+(this.rect.pos.x-this.rect.size.width/2)+"px",this.canvas.style.top=GameGlobals.kickass.scrollPos.y+(this.rect.pos.y-this.rect.size.height/2)+"px"},drawLine:function(t,e,i,s){this.ctx.save(),this.ctx.translate(this.rect.size.width/2,this.rect.size.height/2),this.ctx.beginPath(),this.ctx.moveTo(t,e),this.ctx.lineTo(i,s),this.ctx.closePath(),this.ctx.stroke(),this.ctx.restore()},drawCircle:function(t,e){e=e||{x:0,y:0},this.ctx.save(),this.ctx.translate(this.rect.size.width/2,this.rect.size.height/2),e&&this.ctx.translate(e.x,e.y),this.ctx.beginPath(),this.ctx.arc(0,0,t,0,2*Math.PI,!0),this.ctx.fill(),this.ctx.closePath(),this.ctx.restore()},drawRect:function(t,e,i,s){this.ctx.save(),this.ctx.translate(this.rect.size.width/2,this.rect.size.height/2),this.ctx.translate(t,e),this.ctx.fillRect(t,e,i,s),this.ctx.restore(),this.ctx.fill()},drawImageFull:function(t){this.ctx.drawImage(t,0,0,this.rect.size.width,this.rect.size.height)},drawImage:function(t,e,i){this.ctx.save(),this.ctx.translate(this.rect.size.width/2+e,this.rect.size.height/2+i),this.ctx.rotate(this.angle),this.ctx.drawImage(t,0,-11),this.ctx.restore()},setFillColor:function(t){this.ctx.fillStyle=t},setStrokeColor:function(t){this.ctx.strokeStyle=t},setLineWidth:function(t){this.ctx.lineWidth=t},fillPath:function(){this.ctx.fill()},strokePath:function(){this.ctx.stroke()},clear:function(){this.ctx.clearRect(0,0,this.rect.size.width,this.rect.size.height)},destroy:function(){GameGlobals.kickass.unregisterElement(this.canvas),this.canvas.parentNode.removeChild(this.canvas)}}),Sheet=new Class({initialize:function(t){this.rect=t,this.drawer=new SheetCanvas(t)},clear:function(){this.drawer.clear()},setPosition:function(t){this.rect.pos=t.cp(),this.drawer.rect=this.rect,this.drawer.updateCanvas()},setAngle:function(t){this.drawer.setAngle(t)},drawPlayer:function(t){this.drawer.setFillColor("transparent"),this.drawer.setStrokeColor("#5f5cfa"),this.drawer.setLineWidth(1),this.drawer.tracePoly(t),this.drawer.fillPath(),this.drawer.tracePoly(t),this.drawer.strokePath()},drawBrokenPlayer:function(t,e){this.drawer.setStrokeColor("#4d4aff"),this.drawer.setLineWidth(1);for(var i,s=1,n=t[0];i=t[s];s++,n=i){var o=e[s-1];this.drawer.drawLine(n.x+o.pos.x,n.x+o.pos.y,i.x+o.pos.x,i.y+o.pos.y)}},drawFlames:function(t,e){this.drawer.setLineWidth(1),this.drawer.setFillColor("#fff"),this.drawer.tracePoly(t.r),this.drawer.fillPath(),this.drawer.setFillColor("#dfdfdf"),this.drawer.tracePoly(t.y),this.drawer.fillPath()},drawBullet:function(){this.drawer.setFillColor(GameGlobals.bulletColor),this.drawer.drawCircle(1.5)},drawExplosion:function(t){for(var e,i=0;e=t[i];i++)this.drawer.setFillColor(e.color),this.drawer.drawRect(e.pos.x,e.pos.y,3,3)},drawFace:function(t){this.drawer.drawImageFull(t)},drawLaser:function(t,e){this.clear(),this.setPosition(t),this.drawer.setAngle(e.angle()),this.drawer.drawImage(GameGlobals.laserImage,0,0)},transformToSheetCoordinates:function(t){return t.cp().sub(new Vector(this.rect.size.width/2,this.rect.size.height/2))},destroy:function(){this.drawer.destroy()}}),namespace=getGlobalNamespace(),initKickAss=function(){if(namespace.KICKASSGAME)namespace.KICKASSGAME.addPlayer();else if(namespace.KICKASS_SITE_KEY){var t=new MySite(namespace.KICKASS_SITE_KEY);t.load(function(e){namespace.KICKASSGAME=GameGlobals.kickass=new KickAss({mySite:!!e&&t}),namespace.KICKASSGAME.begin()})}else namespace.KICKASSGAME=GameGlobals.kickass=new KickAss,namespace.KICKASSGAME.begin()};function getAppContainerElement(){return namespace.KICKASS_CONTAINER_ELEMENT?document.getElementById(namespace.KICKASS_CONTAINER_ELEMENT):document.body}namespace.LAZYLOAD_KICKASS?window.startBrowserBlaster=initKickAss:initKickAss()}("undefined"!=typeof exports?exports:window)}),function(){"use strict";function t(t,e){var i;for(i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);return t}function e(t){if(!this||this.find!==e.prototype.find)return new e(t);if(this.length=0,t)if("string"==typeof t&&(t=this.find(t)),t.nodeType||t===t.window)this.length=1,this[0]=t;else{var i=t.length;for(this.length=i;i;)this[i-=1]=t[i]}}e.extend=t,e.contains=function(t,e){do{if((e=e.parentNode)===t)return!0}while(e);return!1},e.parseJSON=function(t){return window.JSON&&JSON.parse(t)},t(e.prototype,{find:function(t){var i=this[0]||document;return"string"==typeof t&&(t=i.querySelectorAll?i.querySelectorAll(t):"#"===t.charAt(0)?i.getElementById(t.slice(1)):i.getElementsByTagName(t)),new e(t)},hasClass:function(t){return!!this[0]&&new RegExp("(^|\\s+)"+t+"(\\s+|$)").test(this[0].className)},addClass:function(t){for(var e,i=this.length;i;){if(!(e=this[i-=1]).className)return e.className=t,this;if(this.hasClass(t))return this;e.className+=" "+t}return this},removeClass:function(t){for(var e,i=new RegExp("(^|\\s+)"+t+"(\\s+|$)"),s=this.length;s;)(e=this[s-=1]).className=e.className.replace(i," ");return this},on:function(t,e){for(var i,s,n=t.split(/\s+/);n.length;)for(t=n.shift(),i=this.length;i;)(s=this[i-=1]).addEventListener?s.addEventListener(t,e,!1):s.attachEvent&&s.attachEvent("on"+t,e);return this},off:function(t,e){for(var i,s,n=t.split(/\s+/);n.length;)for(t=n.shift(),i=this.length;i;)(s=this[i-=1]).removeEventListener?s.removeEventListener(t,e,!1):s.detachEvent&&s.detachEvent("on"+t,e);return this},empty:function(){for(var t,e=this.length;e;)for(t=this[e-=1];t.hasChildNodes();)t.removeChild(t.lastChild);return this},first:function(){return new e(this[0])}}),"function"==typeof define&&define.amd?define(function(){return e}):(window.blueimp=window.blueimp||{},window.blueimp.helper=e)}(),function(t){"use strict";"function"==typeof define&&define.amd?define(["./blueimp-helper"],t):(window.blueimp=window.blueimp||{},window.blueimp.Gallery=t(window.blueimp.helper||window.jQuery))}(function(t){"use strict";function e(t,i){return void 0===document.body.style.maxHeight?null:this&&this.options===e.prototype.options?void(t&&t.length?(this.list=t,this.num=t.length,this.initOptions(i),this.initialize()):this.console.log("blueimp Gallery: No or empty list provided as first argument.",t)):new e(t,i)}return t.extend(e.prototype,{options:{container:"#blueimp-gallery",slidesContainer:"div",titleElement:"h3",displayClass:"blueimp-gallery-display",controlsClass:"blueimp-gallery-controls",singleClass:"blueimp-gallery-single",leftEdgeClass:"blueimp-gallery-left",rightEdgeClass:"blueimp-gallery-right",playingClass:"blueimp-gallery-playing",slideClass:"slide",slideLoadingClass:"slide-loading",slideErrorClass:"slide-error",slideContentClass:"slide-content",toggleClass:"toggle",prevClass:"prev",nextClass:"next",closeClass:"close",playPauseClass:"play-pause",typeProperty:"type",titleProperty:"title",altTextProperty:"alt",urlProperty:"href",srcsetProperty:"urlset",displayTransition:!0,clearSlides:!0,stretchImages:!1,toggleControlsOnReturn:!0,toggleControlsOnSlideClick:!0,toggleSlideshowOnSpace:!0,enableKeyboardNavigation:!0,closeOnEscape:!0,closeOnSlideClick:!0,closeOnSwipeUpOrDown:!0,emulateTouchEvents:!0,stopTouchEventsPropagation:!1,hidePageScrollbars:!0,disableScroll:!0,carousel:!1,continuous:!0,unloadElements:!0,startSlideshow:!1,slideshowInterval:5e3,index:0,preloadRange:2,transitionSpeed:400,slideshowTransitionSpeed:void 0,event:void 0,onopen:void 0,onopened:void 0,onslide:void 0,onslideend:void 0,onslidecomplete:void 0,onclose:void 0,onclosed:void 0},carouselOptions:{hidePageScrollbars:!1,toggleControlsOnReturn:!1,toggleSlideshowOnSpace:!1,enableKeyboardNavigation:!1,closeOnEscape:!1,closeOnSlideClick:!1,closeOnSwipeUpOrDown:!1,disableScroll:!1,startSlideshow:!0},console:window.console&&"function"==typeof window.console.log?window.console:{log:function(){}},support:function(e){var i,s={touch:void 0!==window.ontouchstart||window.DocumentTouch&&document instanceof DocumentTouch},n={webkitTransition:{end:"webkitTransitionEnd",prefix:"-webkit-"},MozTransition:{end:"transitionend",prefix:"-moz-"},OTransition:{end:"otransitionend",prefix:"-o-"},transition:{end:"transitionend",prefix:""}};for(i in n)if(n.hasOwnProperty(i)&&void 0!==e.style[i]){s.transition=n[i],s.transition.name=i;break}function o(){var t,i,n=s.transition;document.body.appendChild(e),n&&(t=n.name.slice(0,-9)+"ransform",void 0!==e.style[t]&&(e.style[t]="translateZ(0)",i=window.getComputedStyle(e).getPropertyValue(n.prefix+"transform"),s.transform={prefix:n.prefix,name:t,translate:!0,translateZ:!!i&&"none"!==i})),void 0!==e.style.backgroundSize&&(s.backgroundSize={},e.style.backgroundSize="contain",s.backgroundSize.contain="contain"===window.getComputedStyle(e).getPropertyValue("background-size"),e.style.backgroundSize="cover",s.backgroundSize.cover="cover"===window.getComputedStyle(e).getPropertyValue("background-size")),document.body.removeChild(e)}return document.body?o():t(document).on("DOMContentLoaded",o),s}(document.createElement("div")),requestAnimationFrame:window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame,cancelAnimationFrame:window.cancelAnimationFrame||window.webkitCancelRequestAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame,initialize:function(){if(this.initStartIndex(),!1===this.initWidget())return!1;this.initEventListeners(),this.onslide(this.index),this.ontransitionend(),this.options.startSlideshow&&this.play()},slide:function(t,e){window.clearTimeout(this.timeout);var i,s,n,o=this.index;if(o!==t&&1!==this.num){if(e||(e=this.options.transitionSpeed),this.support.transform){for(this.options.continuous||(t=this.circle(t)),i=Math.abs(o-t)/(o-t),this.options.continuous&&(s=i,(i=-this.positions[this.circle(t)]/this.slideWidth)!==s&&(t=-i*this.num+t)),n=Math.abs(o-t)-1;n;)n-=1,this.move(this.circle((t>o?t:o)-n-1),this.slideWidth*i,0);t=this.circle(t),this.move(o,this.slideWidth*i,e),this.move(t,0,e),this.options.continuous&&this.move(this.circle(t-i),-this.slideWidth*i,0)}else t=this.circle(t),this.animate(o*-this.slideWidth,t*-this.slideWidth,e);this.onslide(t)}},getIndex:function(){return this.index},getNumber:function(){return this.num},prev:function(){(this.options.continuous||this.index)&&this.slide(this.index-1)},next:function(){(this.options.continuous||this.index<this.num-1)&&this.slide(this.index+1)},play:function(t){var e=this;window.clearTimeout(this.timeout),this.interval=t||this.options.slideshowInterval,this.elements[this.index]>1&&(this.timeout=this.setTimeout(!this.requestAnimationFrame&&this.slide||function(t,i){e.animationFrameId=e.requestAnimationFrame.call(window,function(){e.slide(t,i)})},[this.index+1,this.options.slideshowTransitionSpeed],this.interval)),this.container.addClass(this.options.playingClass)},pause:function(){window.clearTimeout(this.timeout),this.interval=null,this.cancelAnimationFrame&&(this.cancelAnimationFrame.call(window,this.animationFrameId),this.animationFrameId=null),this.container.removeClass(this.options.playingClass)},add:function(t){var e;for(t.concat||(t=Array.prototype.slice.call(t)),this.list.concat||(this.list=Array.prototype.slice.call(this.list)),this.list=this.list.concat(t),this.num=this.list.length,this.num>2&&null===this.options.continuous&&(this.options.continuous=!0,this.container.removeClass(this.options.leftEdgeClass)),this.container.removeClass(this.options.rightEdgeClass).removeClass(this.options.singleClass),e=this.num-t.length;e<this.num;e+=1)this.addSlide(e),this.positionSlide(e);this.positions.length=this.num,this.initSlides(!0)},resetSlides:function(){this.slidesContainer.empty(),this.unloadAllSlides(),this.slides=[]},handleClose:function(){var t=this.options;this.destroyEventListeners(),this.pause(),this.container[0].style.display="none",this.container.removeClass(t.displayClass).removeClass(t.singleClass).removeClass(t.leftEdgeClass).removeClass(t.rightEdgeClass),t.hidePageScrollbars&&(document.body.style.overflow=this.bodyOverflowStyle),this.options.clearSlides&&this.resetSlides(),this.options.onclosed&&this.options.onclosed.call(this)},close:function(){var t=this;this.options.onclose&&this.options.onclose.call(this),this.support.transition&&this.options.displayTransition?(this.container.on(this.support.transition.end,function e(i){i.target===t.container[0]&&(t.container.off(t.support.transition.end,e),t.handleClose())}),this.container.removeClass(this.options.displayClass)):this.handleClose()},circle:function(t){return(this.num+t%this.num)%this.num},move:function(t,e,i){this.translateX(t,e,i),this.positions[t]=e},translate:function(t,e,i,s){var n=this.slides[t].style,o=this.support.transition,a=this.support.transform;n[o.name+"Duration"]=s+"ms",n[a.name]="translate("+e+"px, "+i+"px)"+(a.translateZ?" translateZ(0)":"")},translateX:function(t,e,i){this.translate(t,e,0,i)},translateY:function(t,e,i){this.translate(t,0,e,i)},animate:function(t,e,i){if(i)var s=this,n=(new Date).getTime(),o=window.setInterval(function(){var a=(new Date).getTime()-n;if(a>i)return s.slidesContainer[0].style.left=e+"px",s.ontransitionend(),void window.clearInterval(o);s.slidesContainer[0].style.left=(e-t)*(Math.floor(a/i*100)/100)+t+"px"},4);else this.slidesContainer[0].style.left=e+"px"},preventDefault:function(t){t.preventDefault?t.preventDefault():t.returnValue=!1},stopPropagation:function(t){t.stopPropagation?t.stopPropagation():t.cancelBubble=!0},onresize:function(){this.initSlides(!0)},onmousedown:function(t){t.which&&1===t.which&&"VIDEO"!==t.target.nodeName&&"AUDIO"!==t.target.nodeName&&(t.preventDefault(),(t.originalEvent||t).touches=[{pageX:t.pageX,pageY:t.pageY}],this.ontouchstart(t))},onmousemove:function(t){this.touchStart&&((t.originalEvent||t).touches=[{pageX:t.pageX,pageY:t.pageY}],this.ontouchmove(t))},onmouseup:function(t){this.touchStart&&(this.ontouchend(t),delete this.touchStart)},onmouseout:function(e){if(this.touchStart){var i=e.target,s=e.relatedTarget;s&&(s===i||t.contains(i,s))||this.onmouseup(e)}},ontouchstart:function(t){this.options.stopTouchEventsPropagation&&this.stopPropagation(t);var e=(t.originalEvent||t).touches[0];this.touchStart={x:e.pageX,y:e.pageY,time:Date.now()},this.isScrolling=void 0,this.touchDelta={}},ontouchmove:function(t){this.options.stopTouchEventsPropagation&&this.stopPropagation(t);var e,i,s=(t.originalEvent||t).touches[0],n=(t.originalEvent||t).scale,o=this.index;if(!(s.length>1||n&&1!==n))if(this.options.disableScroll&&t.preventDefault(),this.touchDelta={x:s.pageX-this.touchStart.x,y:s.pageY-this.touchStart.y},e=this.touchDelta.x,void 0===this.isScrolling&&(this.isScrolling=this.isScrolling||Math.abs(e)<Math.abs(this.touchDelta.y)),this.isScrolling)this.translateY(o,this.touchDelta.y+this.positions[o],0);else for(t.preventDefault(),window.clearTimeout(this.timeout),this.options.continuous?i=[this.circle(o+1),o,this.circle(o-1)]:(this.touchDelta.x=e/=!o&&e>0||o===this.num-1&&e<0?Math.abs(e)/this.slideWidth+1:1,i=[o],o&&i.push(o-1),o<this.num-1&&i.unshift(o+1));i.length;)o=i.pop(),this.translateX(o,e+this.positions[o],0)},ontouchend:function(t){this.options.stopTouchEventsPropagation&&this.stopPropagation(t);var e,i,s,n,o,a=this.index,r=this.options.transitionSpeed,l=this.slideWidth,h=Number(Date.now()-this.touchStart.time)<250,c=h&&Math.abs(this.touchDelta.x)>20||Math.abs(this.touchDelta.x)>l/2,d=!a&&this.touchDelta.x>0||a===this.num-1&&this.touchDelta.x<0,u=!c&&this.options.closeOnSwipeUpOrDown&&(h&&Math.abs(this.touchDelta.y)>20||Math.abs(this.touchDelta.y)>this.slideHeight/2);this.options.continuous&&(d=!1),e=this.touchDelta.x<0?-1:1,this.isScrolling?u?this.close():this.translateY(a,0,r):c&&!d?(i=a+e,s=a-e,n=l*e,o=-l*e,this.options.continuous?(this.move(this.circle(i),n,0),this.move(this.circle(a-2*e),o,0)):i>=0&&i<this.num&&this.move(i,n,0),this.move(a,this.positions[a]+n,r),this.move(this.circle(s),this.positions[this.circle(s)]+n,r),a=this.circle(s),this.onslide(a)):this.options.continuous?(this.move(this.circle(a-1),-l,r),this.move(a,0,r),this.move(this.circle(a+1),l,r)):(a&&this.move(a-1,-l,r),this.move(a,0,r),a<this.num-1&&this.move(a+1,l,r))},ontouchcancel:function(t){this.touchStart&&(this.ontouchend(t),delete this.touchStart)},ontransitionend:function(t){var e=this.slides[this.index];t&&e!==t.target||(this.interval&&this.play(),this.setTimeout(this.options.onslideend,[this.index,e]))},oncomplete:function(e){var i,s=e.target||e.srcElement,n=s&&s.parentNode;s&&n&&(i=this.getNodeIndex(n),t(n).removeClass(this.options.slideLoadingClass),"error"===e.type?(t(n).addClass(this.options.slideErrorClass),this.elements[i]=3):this.elements[i]=2,s.clientHeight>this.container[0].clientHeight&&(s.style.maxHeight=this.container[0].clientHeight),this.interval&&this.slides[this.index]===n&&this.play(),this.setTimeout(this.options.onslidecomplete,[i,n]))},onload:function(t){this.oncomplete(t)},onerror:function(t){this.oncomplete(t)},onkeydown:function(t){switch(t.which||t.keyCode){case 13:this.options.toggleControlsOnReturn&&(this.preventDefault(t),this.toggleControls());break;case 27:this.options.closeOnEscape&&(this.close(),t.stopImmediatePropagation());break;case 32:this.options.toggleSlideshowOnSpace&&(this.preventDefault(t),this.toggleSlideshow());break;case 37:this.options.enableKeyboardNavigation&&(this.preventDefault(t),this.prev());break;case 39:this.options.enableKeyboardNavigation&&(this.preventDefault(t),this.next())}},handleClick:function(e){var i=this.options,s=e.target||e.srcElement,n=s.parentNode;function o(e){return t(s).hasClass(e)||t(n).hasClass(e)}o(i.toggleClass)?(this.preventDefault(e),this.toggleControls()):o(i.prevClass)?(this.preventDefault(e),this.prev()):o(i.nextClass)?(this.preventDefault(e),this.next()):o(i.closeClass)?(this.preventDefault(e),this.close()):o(i.playPauseClass)?(this.preventDefault(e),this.toggleSlideshow()):n===this.slidesContainer[0]?i.closeOnSlideClick?(this.preventDefault(e),this.close()):i.toggleControlsOnSlideClick&&(this.preventDefault(e),this.toggleControls()):n.parentNode&&n.parentNode===this.slidesContainer[0]&&i.toggleControlsOnSlideClick&&(this.preventDefault(e),this.toggleControls())},onclick:function(t){if(!(this.options.emulateTouchEvents&&this.touchDelta&&(Math.abs(this.touchDelta.x)>20||Math.abs(this.touchDelta.y)>20)))return this.handleClick(t);delete this.touchDelta},updateEdgeClasses:function(t){t?this.container.removeClass(this.options.leftEdgeClass):this.container.addClass(this.options.leftEdgeClass),t===this.num-1?this.container.addClass(this.options.rightEdgeClass):this.container.removeClass(this.options.rightEdgeClass)},handleSlide:function(t){this.options.continuous||this.updateEdgeClasses(t),this.loadElements(t),this.options.unloadElements&&this.unloadElements(t),this.setTitle(t)},onslide:function(t){this.index=t,this.handleSlide(t),this.setTimeout(this.options.onslide,[t,this.slides[t]])},setTitle:function(t){var e=this.slides[t].firstChild,i=e.title||e.alt,s=this.titleElement;s.length&&(this.titleElement.empty(),i&&s[0].appendChild(document.createTextNode(i)))},setTimeout:function(t,e,i){var s=this;return t&&window.setTimeout(function(){t.apply(s,e||[])},i||0)},imageFactory:function(e,i){var s,n,o,a,r=this,l=this.imagePrototype.cloneNode(!1),h=e,c=this.options.stretchImages;return"string"!=typeof h&&(h=this.getItemProperty(e,this.options.urlProperty),o=this.getItemProperty(e,this.options.titleProperty),a=this.getItemProperty(e,this.options.altTextProperty)||o),!0===c&&(c="contain"),(c=this.support.backgroundSize&&this.support.backgroundSize[c]&&c)?n=this.elementPrototype.cloneNode(!1):(n=l,l.draggable=!1),o&&(n.title=o),a&&(n.alt=a),t(l).on("load error",function e(o){if(!s){if(o={type:o.type,target:n},!n.parentNode)return r.setTimeout(e,[o]);s=!0,t(l).off("load error",e),c&&"load"===o.type&&(n.style.background='url("'+h+'") center no-repeat',n.style.backgroundSize=c),i(o)}}),l.src=h,n},createElement:function(e,i){var s=e&&this.getItemProperty(e,this.options.typeProperty),n=s&&this[s.split("/")[0]+"Factory"]||this.imageFactory,o=e&&n.call(this,e,i),a=this.getItemProperty(e,this.options.srcsetProperty);return o||(o=this.elementPrototype.cloneNode(!1),this.setTimeout(i,[{type:"error",target:o}])),a&&o.setAttribute("srcset",a),t(o).addClass(this.options.slideContentClass),o},loadElement:function(e){this.elements[e]||(this.slides[e].firstChild?this.elements[e]=t(this.slides[e]).hasClass(this.options.slideErrorClass)?3:2:(this.elements[e]=1,t(this.slides[e]).addClass(this.options.slideLoadingClass),this.slides[e].appendChild(this.createElement(this.list[e],this.proxyListener))))},loadElements:function(t){var e,i=Math.min(this.num,2*this.options.preloadRange+1),s=t;for(e=0;e<i;e+=1)s+=e*(e%2==0?-1:1),s=this.circle(s),this.loadElement(s)},unloadElements:function(t){var e,i;for(e in this.elements)this.elements.hasOwnProperty(e)&&(i=Math.abs(t-e))>this.options.preloadRange&&i+this.options.preloadRange<this.num&&(this.unloadSlide(e),delete this.elements[e])},addSlide:function(t){var e=this.slidePrototype.cloneNode(!1);e.setAttribute("data-index",t),this.slidesContainer[0].appendChild(e),this.slides.push(e)},positionSlide:function(t){var e=this.slides[t];e.style.width=this.slideWidth+"px",this.support.transform&&(e.style.left=t*-this.slideWidth+"px",this.move(t,this.index>t?-this.slideWidth:this.index<t?this.slideWidth:0,0))},initSlides:function(e){var i,s;for(e||(this.positions=[],this.positions.length=this.num,this.elements={},this.imagePrototype=document.createElement("img"),this.elementPrototype=document.createElement("div"),this.slidePrototype=document.createElement("div"),t(this.slidePrototype).addClass(this.options.slideClass),this.slides=this.slidesContainer[0].children,i=this.options.clearSlides||this.slides.length!==this.num),this.slideWidth=this.container[0].clientWidth,this.slideHeight=this.container[0].clientHeight,this.slidesContainer[0].style.width=this.num*this.slideWidth+"px",i&&this.resetSlides(),s=0;s<this.num;s+=1)i&&this.addSlide(s),this.positionSlide(s);this.options.continuous&&this.support.transform&&(this.move(this.circle(this.index-1),-this.slideWidth,0),this.move(this.circle(this.index+1),this.slideWidth,0)),this.support.transform||(this.slidesContainer[0].style.left=this.index*-this.slideWidth+"px")},unloadSlide:function(t){var e,i;null!==(i=(e=this.slides[t]).firstChild)&&e.removeChild(i)},unloadAllSlides:function(){var t,e;for(t=0,e=this.slides.length;t<e;t++)this.unloadSlide(t)},toggleControls:function(){var t=this.options.controlsClass;this.container.hasClass(t)?this.container.removeClass(t):this.container.addClass(t)},toggleSlideshow:function(){this.interval?this.pause():this.play()},getNodeIndex:function(t){return parseInt(t.getAttribute("data-index"),10)},getNestedProperty:function(t,e){return e.replace(/\[(?:'([^']+)'|"([^"]+)"|(\d+))\]|(?:(?:^|\.)([^\.\[]+))/g,function(e,i,s,n,o){var a=o||i||s||n&&parseInt(n,10);e&&t&&(t=t[a])}),t},getDataProperty:function(e,i){var s,n;if(e.dataset?(s=i.replace(/-([a-z])/g,function(t,e){return e.toUpperCase()}),n=e.dataset[s]):e.getAttribute&&(n=e.getAttribute("data-"+i.replace(/([A-Z])/g,"-$1").toLowerCase())),"string"==typeof n){if(/^(true|false|null|-?\d+(\.\d+)?|\{[\s\S]*\}|\[[\s\S]*\])$/.test(n))try{return t.parseJSON(n)}catch(t){}return n}},getItemProperty:function(t,e){var i=this.getDataProperty(t,e);return void 0===i&&(i=t[e]),void 0===i&&(i=this.getNestedProperty(t,e)),i},initStartIndex:function(){var t,e=this.options.index,i=this.options.urlProperty;if(e&&"number"!=typeof e)for(t=0;t<this.num;t+=1)if(this.list[t]===e||this.getItemProperty(this.list[t],i)===this.getItemProperty(e,i)){e=t;break}this.index=this.circle(parseInt(e,10)||0)},initEventListeners:function(){var e=this,i=this.slidesContainer;function s(t){var i=e.support.transition&&e.support.transition.end===t.type?"transitionend":t.type;e["on"+i](t)}t(window).on("resize",s),t(document.body).on("keydown",s),this.container.on("click",s),this.support.touch?i.on("touchstart touchmove touchend touchcancel",s):this.options.emulateTouchEvents&&this.support.transition&&i.on("mousedown mousemove mouseup mouseout",s),this.support.transition&&i.on(this.support.transition.end,s),this.proxyListener=s},destroyEventListeners:function(){var e=this.slidesContainer,i=this.proxyListener;t(window).off("resize",i),t(document.body).off("keydown",i),this.container.off("click",i),this.support.touch?e.off("touchstart touchmove touchend touchcancel",i):this.options.emulateTouchEvents&&this.support.transition&&e.off("mousedown mousemove mouseup mouseout",i),this.support.transition&&e.off(this.support.transition.end,i)},handleOpen:function(){this.options.onopened&&this.options.onopened.call(this)},initWidget:function(){var e=this;return this.container=t(this.options.container),this.container.length?(this.slidesContainer=this.container.find(this.options.slidesContainer).first(),this.slidesContainer.length?(this.titleElement=this.container.find(this.options.titleElement).first(),1===this.num&&this.container.addClass(this.options.singleClass),this.options.onopen&&this.options.onopen.call(this),this.support.transition&&this.options.displayTransition?this.container.on(this.support.transition.end,function t(i){i.target===e.container[0]&&(e.container.off(e.support.transition.end,t),e.handleOpen())}):this.handleOpen(),this.options.hidePageScrollbars&&(this.bodyOverflowStyle=document.body.style.overflow,document.body.style.overflow="hidden"),this.container[0].style.display="block",this.initSlides(),void this.container.addClass(this.options.displayClass)):(this.console.log("blueimp Gallery: Slides container not found.",this.options.slidesContainer),!1)):(this.console.log("blueimp Gallery: Widget container not found.",this.options.container),!1)},initOptions:function(e){this.options=t.extend({},this.options),(e&&e.carousel||this.options.carousel&&(!e||!1!==e.carousel))&&t.extend(this.options,this.carouselOptions),t.extend(this.options,e),this.num<3&&(this.options.continuous=!!this.options.continuous&&null),this.support.transition||(this.options.emulateTouchEvents=!1),this.options.event&&this.preventDefault(this.options.event)}}),e}),function(t){"use strict";"function"==typeof define&&define.amd?define(["./blueimp-helper","./blueimp-gallery"],t):t(window.blueimp.helper||window.jQuery,window.blueimp.Gallery)}(function(t,e){"use strict";t.extend(e.prototype.options,{fullScreen:!1});var i=e.prototype.initialize,s=e.prototype.close;return t.extend(e.prototype,{getFullScreenElement:function(){return document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement},requestFullScreen:function(t){t.requestFullscreen?t.requestFullscreen():t.webkitRequestFullscreen?t.webkitRequestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.msRequestFullscreen&&t.msRequestFullscreen()},exitFullScreen:function(){document.exitFullscreen?document.exitFullscreen():document.webkitCancelFullScreen?document.webkitCancelFullScreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.msExitFullscreen&&document.msExitFullscreen()},initialize:function(){i.call(this),this.options.fullScreen&&!this.getFullScreenElement()&&this.requestFullScreen(this.container[0])},close:function(){this.getFullScreenElement()===this.container[0]&&this.exitFullScreen(),s.call(this)}}),e}),function(t){"use strict";"function"==typeof define&&define.amd?define(["./blueimp-helper","./blueimp-gallery"],t):t(window.blueimp.helper||window.jQuery,window.blueimp.Gallery)}(function(t,e){"use strict";t.extend(e.prototype.options,{indicatorContainer:"ol",activeIndicatorClass:"active",thumbnailProperty:"thumbnail",thumbnailIndicators:!0});var i=e.prototype.initSlides,s=e.prototype.addSlide,n=e.prototype.resetSlides,o=e.prototype.handleClick,a=e.prototype.handleSlide,r=e.prototype.handleClose;return t.extend(e.prototype,{createIndicator:function(e){var i,s,n=this.indicatorPrototype.cloneNode(!1),o=this.getItemProperty(e,this.options.titleProperty),a=this.options.thumbnailProperty;return this.options.thumbnailIndicators&&(a&&(i=this.getItemProperty(e,a)),void 0===i&&(s=e.getElementsByTagName&&t(e).find("img")[0])&&(i=s.src),i&&(n.style.backgroundImage='url("'+i+'")')),o&&(n.title=o),n},addIndicator:function(t){if(this.indicatorContainer.length){var e=this.createIndicator(this.list[t]);e.setAttribute("data-index",t),this.indicatorContainer[0].appendChild(e),this.indicators.push(e)}},setActiveIndicator:function(e){this.indicators&&(this.activeIndicator&&this.activeIndicator.removeClass(this.options.activeIndicatorClass),this.activeIndicator=t(this.indicators[e]),this.activeIndicator.addClass(this.options.activeIndicatorClass))},initSlides:function(t){t||(this.indicatorContainer=this.container.find(this.options.indicatorContainer),this.indicatorContainer.length&&(this.indicatorPrototype=document.createElement("li"),this.indicators=this.indicatorContainer[0].children)),i.call(this,t)},addSlide:function(t){s.call(this,t),this.addIndicator(t)},resetSlides:function(){n.call(this),this.indicatorContainer.empty(),this.indicators=[]},handleClick:function(t){var e=t.target||t.srcElement,i=e.parentNode;if(i===this.indicatorContainer[0])this.preventDefault(t),this.slide(this.getNodeIndex(e));else{if(i.parentNode!==this.indicatorContainer[0])return o.call(this,t);this.preventDefault(t),this.slide(this.getNodeIndex(i))}},handleSlide:function(t){a.call(this,t),this.setActiveIndicator(t)},handleClose:function(){this.activeIndicator&&this.activeIndicator.removeClass(this.options.activeIndicatorClass),r.call(this)}}),e}),function(t){"use strict";"function"==typeof define&&define.amd?define(["./blueimp-helper","./blueimp-gallery"],t):t(window.blueimp.helper||window.jQuery,window.blueimp.Gallery)}(function(t,e){"use strict";t.extend(e.prototype.options,{videoContentClass:"video-content",videoLoadingClass:"video-loading",videoPlayingClass:"video-playing",videoPosterProperty:"poster",videoSourcesProperty:"sources"});var i=e.prototype.handleSlide;return t.extend(e.prototype,{handleSlide:function(t){i.call(this,t),this.playingVideo&&this.playingVideo.pause()},videoFactory:function(e,i,s){var n,o,a,r,l,h=this,c=this.options,d=this.elementPrototype.cloneNode(!1),u=t(d),p=[{type:"error",target:d}],m=s||document.createElement("video"),f=this.getItemProperty(e,c.urlProperty),g=this.getItemProperty(e,c.typeProperty),y=this.getItemProperty(e,c.titleProperty),v=this.getItemProperty(e,this.options.altTextProperty)||y,w=this.getItemProperty(e,c.videoPosterProperty),b=this.getItemProperty(e,c.videoSourcesProperty);if(u.addClass(c.videoContentClass),y&&(d.title=y),m.canPlayType)if(f&&g&&m.canPlayType(g))m.src=f;else if(b)for(;b.length;)if(o=b.shift(),f=this.getItemProperty(o,c.urlProperty),g=this.getItemProperty(o,c.typeProperty),f&&g&&m.canPlayType(g)){m.src=f;break}return w&&(m.poster=w,n=this.imagePrototype.cloneNode(!1),t(n).addClass(c.toggleClass),n.src=w,n.draggable=!1,n.alt=v,d.appendChild(n)),(a=document.createElement("a")).setAttribute("target","_blank"),s||a.setAttribute("download",y),a.href=f,m.src&&(m.controls=!0,(s||t(m)).on("error",function(){h.setTimeout(i,p)}).on("pause",function(){m.seeking||(r=!1,u.removeClass(h.options.videoLoadingClass).removeClass(h.options.videoPlayingClass),l&&h.container.addClass(h.options.controlsClass),delete h.playingVideo,h.interval&&h.play())}).on("playing",function(){r=!1,u.removeClass(h.options.videoLoadingClass).addClass(h.options.videoPlayingClass),h.container.hasClass(h.options.controlsClass)?(l=!0,h.container.removeClass(h.options.controlsClass)):l=!1}).on("play",function(){window.clearTimeout(h.timeout),r=!0,u.addClass(h.options.videoLoadingClass),h.playingVideo=m}),t(a).on("click",function(t){h.preventDefault(t),r?m.pause():m.play()}),d.appendChild(s&&s.element||m)),d.appendChild(a),this.setTimeout(i,[{type:"load",target:d}]),d}}),e}),function(t){"use strict";"function"==typeof define&&define.amd?define(["./blueimp-helper","./blueimp-gallery-video"],t):t(window.blueimp.helper||window.jQuery,window.blueimp.Gallery)}(function(t,e){"use strict";if(!window.postMessage)return e;t.extend(e.prototype.options,{vimeoVideoIdProperty:"vimeo",vimeoPlayerUrl:"//player.vimeo.com/video/VIDEO_ID?api=1&player_id=PLAYER_ID",vimeoPlayerIdPrefix:"vimeo-player-",vimeoClickToPlay:!0});var i=e.prototype.textFactory||e.prototype.imageFactory,s=function(t,e,i,s){this.url=t,this.videoId=e,this.playerId=i,this.clickToPlay=s,this.element=document.createElement("div"),this.listeners={}},n=0;return t.extend(s.prototype,{canPlayType:function(){return!0},on:function(t,e){return this.listeners[t]=e,this},loadAPI:function(){var e,i,s=this,n="//f.vimeocdn.com/js/froogaloop2.min.js",o=document.getElementsByTagName("script"),a=o.length;function r(){!i&&s.playOnReady&&s.play(),i=!0}for(;a;)if(o[a-=1].src===n){e=o[a];break}e||((e=document.createElement("script")).src=n),t(e).on("load",r),o[0].parentNode.insertBefore(e,o[0]),/loaded|complete/.test(e.readyState)&&r()},onReady:function(){var t=this;this.ready=!0,this.player.addEvent("play",function(){t.hasPlayed=!0,t.onPlaying()}),this.player.addEvent("pause",function(){t.onPause()}),this.player.addEvent("finish",function(){t.onPause()}),this.playOnReady&&this.play()},onPlaying:function(){this.playStatus<2&&(this.listeners.playing(),this.playStatus=2)},onPause:function(){this.listeners.pause(),delete this.playStatus},insertIframe:function(){var t=document.createElement("iframe");t.src=this.url.replace("VIDEO_ID",this.videoId).replace("PLAYER_ID",this.playerId),t.id=this.playerId,this.element.parentNode.replaceChild(t,this.element),this.element=t},play:function(){var t=this;this.playStatus||(this.listeners.play(),this.playStatus=1),this.ready?!this.hasPlayed&&(this.clickToPlay||window.navigator&&/iP(hone|od|ad)/.test(window.navigator.platform))?this.onPlaying():this.player.api("play"):(this.playOnReady=!0,window.$f?this.player||(this.insertIframe(),this.player=$f(this.element),this.player.addEvent("ready",function(){t.onReady()})):this.loadAPI())},pause:function(){this.ready?this.player.api("pause"):this.playStatus&&(delete this.playOnReady,this.listeners.pause(),delete this.playStatus)}}),t.extend(e.prototype,{VimeoPlayer:s,textFactory:function(t,e){var o=this.options,a=this.getItemProperty(t,o.vimeoVideoIdProperty);return a?(void 0===this.getItemProperty(t,o.urlProperty)&&(t[o.urlProperty]="//vimeo.com/"+a),n+=1,this.videoFactory(t,e,new s(o.vimeoPlayerUrl,a,o.vimeoPlayerIdPrefix+n,o.vimeoClickToPlay))):i.call(this,t,e)}}),e}),function(t){"use strict";"function"==typeof define&&define.amd?define(["./blueimp-helper","./blueimp-gallery-video"],t):t(window.blueimp.helper||window.jQuery,window.blueimp.Gallery)}(function(t,e){"use strict";if(!window.postMessage)return e;t.extend(e.prototype.options,{youTubeVideoIdProperty:"youtube",youTubePlayerVars:{wmode:"transparent"},youTubeClickToPlay:!0});var i=e.prototype.textFactory||e.prototype.imageFactory,s=function(t,e,i){this.videoId=t,this.playerVars=e,this.clickToPlay=i,this.element=document.createElement("div"),this.listeners={}};return t.extend(s.prototype,{canPlayType:function(){return!0},on:function(t,e){return this.listeners[t]=e,this},loadAPI:function(){var t,e=this,i=window.onYouTubeIframeAPIReady,s="//www.youtube.com/iframe_api",n=document.getElementsByTagName("script"),o=n.length;for(window.onYouTubeIframeAPIReady=function(){i&&i.apply(this),e.playOnReady&&e.play()};o;)if(n[o-=1].src===s)return;(t=document.createElement("script")).src=s,n[0].parentNode.insertBefore(t,n[0])},onReady:function(){this.ready=!0,this.playOnReady&&this.play()},onPlaying:function(){this.playStatus<2&&(this.listeners.playing(),this.playStatus=2)},onPause:function(){e.prototype.setTimeout.call(this,this.checkSeek,null,2e3)},checkSeek:function(){this.stateChange!==YT.PlayerState.PAUSED&&this.stateChange!==YT.PlayerState.ENDED||(this.listeners.pause(),delete this.playStatus)},onStateChange:function(t){switch(t.data){case YT.PlayerState.PLAYING:this.hasPlayed=!0,this.onPlaying();break;case YT.PlayerState.PAUSED:case YT.PlayerState.ENDED:this.onPause()}this.stateChange=t.data},onError:function(t){this.listeners.error(t)},play:function(){var t=this;this.playStatus||(this.listeners.play(),this.playStatus=1),this.ready?!this.hasPlayed&&(this.clickToPlay||window.navigator&&/iP(hone|od|ad)/.test(window.navigator.platform))?this.onPlaying():this.player.playVideo():(this.playOnReady=!0,window.YT&&YT.Player?this.player||(this.player=new YT.Player(this.element,{videoId:this.videoId,playerVars:this.playerVars,events:{onReady:function(){t.onReady()},onStateChange:function(e){t.onStateChange(e)},onError:function(e){t.onError(e)}}})):this.loadAPI())},pause:function(){this.ready?this.player.pauseVideo():this.playStatus&&(delete this.playOnReady,this.listeners.pause(),delete this.playStatus)}}),t.extend(e.prototype,{YouTubePlayer:s,textFactory:function(t,e){var n=this.options,o=this.getItemProperty(t,n.youTubeVideoIdProperty);return o?(void 0===this.getItemProperty(t,n.urlProperty)&&(t[n.urlProperty]="//www.youtube.com/watch?v="+o),void 0===this.getItemProperty(t,n.videoPosterProperty)&&(t[n.videoPosterProperty]="//img.youtube.com/vi/"+o+"/maxresdefault.jpg"),this.videoFactory(t,e,new s(o,n.youTubePlayerVars,n.youTubeClickToPlay))):i.call(this,t,e)}}),e}),function(t){"use strict";"function"==typeof define&&define.amd?define(["jquery","./blueimp-gallery"],t):t(window.jQuery,window.blueimp.Gallery)}(function(t,e){"use strict";t(document).on("click","[data-gallery]",function(i){var s=t(this).data("gallery"),n=t(s),o=n.length&&n||t(e.prototype.options.container),a={onopen:function(){o.data("gallery",this).trigger("open")},onopened:function(){o.trigger("opened")},onslide:function(){o.trigger("slide",arguments)},onslideend:function(){o.trigger("slideend",arguments)},onslidecomplete:function(){o.trigger("slidecomplete",arguments)},onclose:function(){o.trigger("close")},onclosed:function(){o.trigger("closed").removeData("gallery")}},r=t.extend(o.data(),{container:o[0],index:this,event:i},a),l=t(this).closest("[data-gallery-group], body").find('[data-gallery="'+s+'"]');return r.filter&&(l=l.filter(r.filter)),new e(l,r)})}),document.body.classList.remove("no-js"),document.body.classList.add("js"),sessionStorage.setItem("chat_greeting_visits",Number(sessionStorage.getItem("chat_greeting_visits"))+1);let images=document.querySelectorAll(".lazyload");lazyload(images,{root:null,rootMargin:"0px",threshold:0}),function(t){t(".scroll-to-form").click(function(e){e.preventDefault();var i=t(".block-wide-text");t("html, body").animate({scrollTop:i.offset().top},"slow")});var e=document.getElementById("gallery");void 0!==e&&null!=e&&(document.getElementById("gallery").onclick=function(t){var e=(t=t||window.event).target||t.srcElement,i={index:e.src?e.parentNode:e,event:t,fullScreen:!1,stretchImages:"cover",onopen:function(t,e){current=this.getIndex(),total=this.getNumber(),document.getElementById("pos").textContent=current+1,document.getElementById("count").textContent=total},onslide:function(t,e){current=this.getIndex(),total=this.getNumber(),document.getElementById("pos").textContent=current+1,document.getElementById("count").textContent=total}},s=this.getElementsByTagName("a");blueimp.Gallery(s,i)}),window.innerHeight<window.innerWidth?t(".please-rotate-nag").addClass("is-landscape"):t(".please-rotate-nag").removeClass("is-landscape"),jQuery(window).resize(function(){window.innerHeight<window.innerWidth?t(".please-rotate-nag").addClass("is-landscape"):t(".please-rotate-nag").removeClass("is-landscape")}),t(window).scroll(function(){t(this).scrollTop()>300?t(".top").addClass("is-visible"):t(".top").removeClass("is-visible"),t(this).scrollTop()>1200?t(".top").addClass("fade-out"):t(".top").removeClass("fade-out")}),t(function(){t(".col-timeline .row .action").on("click",function(){t(".col-timeline .row").removeClass("active");var e=t(this).attr("data-image"),i=t(this).attr("data-label");t(this).parent().addClass("active"),document.getElementById("dynamicimage").style.backgroundImage="url("+e+")",t("#dynamiclabel span").animate({opacity:0},500,function(){t(this).text(i)}).animate({opacity:1},500)}),t(".accordion").each(function(){var e=t(this);if(e.attr("data-href")==window.location.hash){if(t(".accordion").removeClass("open-accordion"),e.next(".accordion-content").is(":hidden"))t(".accordion-content").stop(!0,!1).slideUp(225),e.next(".accordion-content").stop(!0,!1).slideDown(250,function(){t(this).css({display:"grid"}),t("html, body").animate({scrollTop:e.offset().top-100},200)}),e.addClass("open-accordion"),t(".accordion").children(".arr").removeClass("open"),e.children(".arr").addClass("open"),window.location.hash=e.attr("data-href");else{e.removeClass("open-accordion"),t(".accordion").children(".arr").removeClass("open"),t(".accordion-content").stop(!0,!1).slideUp(250);t(this).attr("data-href");window.location.hash=e.attr("data-href")}return!1}}),t(".accordion").on("click",function(){var e=t(this);if(t(".accordion").removeClass("open-accordion"),e.next(".accordion-content").is(":hidden"))t(".accordion-content").stop(!0,!1).slideUp(225),e.next(".accordion-content").stop(!0,!1).slideDown(250,function(){t(this).css({display:"grid"}),t("html, body").animate({scrollTop:e.offset().top-100},200)}),e.addClass("open-accordion"),t(".accordion").children(".arr").removeClass("open"),e.children(".arr").addClass("open"),window.location.hash=e.attr("data-href");else{e.removeClass("open-accordion"),t(".accordion").children(".arr").removeClass("open"),t(".accordion-content").stop(!0,!1).slideUp(250);t(this).attr("data-href");window.location.hash=e.attr("data-href")}});var e=document;if(t("#service-switcher").length)for(var s=e.getElementById("service-switcher").getElementsByTagName("button"),n=e.getElementById("highlight"),o=0,a=s.length;o<a;o++)s[o].addEventListener("mouseover",function(t){var i=t.target;e.getElementById("init");n.style.top=i.offsetTop+"px"}),s[o].addEventListener("mouseout",function(t){var i=t.target,s=e.getElementById("init"),o=document.getElementsByClassName("clicked");if(void 0!==o)var a=o[0].offsetTop+"px";i.classList.contains("clicked")?(n.style.top=a,i.classList.add("has-focus")):(void 0!==a?n.style.top=a:(n.style.top=0,s.classList.add("has-focus")),i.classList.remove("clicked"))}),s[o].addEventListener("click",function(e){var i=e.target;jQuery(".service-switcher button").removeClass("has-focus clicked"),i.classList.add("clicked"),i.classList.add("has-focus"),n.style.top=i.offsetTop+"px";var s=i.getAttribute("data-tab");jQuery(".content-tab").fadeOut(600,function(){t(this).removeClass("is-visible")}),jQuery("#"+s).addClass("animating"),jQuery("#"+s).fadeIn(600,function(){t(this).addClass("is-visible"),t(this).removeClass("animating")})});t(".dude-nav-more button").hover(function(){t(this).parent().parent().addClass("fade-out")},function(){t(this).parent().parent().removeClass("fade-out")}),setTimeout(function(){t(".opacity-on-load").addClass("fade-in")},500),setTimeout(function(){t(".block-hero").addClass("block-hero-enable-transition")},3e3),t(".opacity-on-load-instant").addClass("fade-in"),t(".block-hero-enable-transition .content").addClass("has-loaded");var r=new MoveTo,l=document.getElementById("target");r.move(l);var h=document.getElementsByClassName("js-trigger")[0];function c(){if(!jQuery("body").hasClass("page-id-4487")){if(jQuery("body").hasClass("page-id-4485"))var e=["Uutta ilmettä putiikille? Kysy lisää chatissa.","Moi! Mille työn jälki vaikuttaa? 🙂","Moro! Voisimmeko auttaa jotenkin? 👋"];else if(jQuery("body").hasClass("page-id-9"))e=["Moottoritie on kuuma, mutta webisivut pitäs saada? 🚀","Verkkosivut uudistuksen tarpeessa? Pistä viestiä niin kerron vähän lisää meidän palveluista. 🙂","Moro! Voisimmeko auttaa jotenkin? 👋"];else e=["Moi! Verkkosivut uudistuksen tarpeessa? Uutta ilmettä putiikille? Kysy lisää chatissa.","Moro! Voisimmeko auttaa jotenkin? 🙂","Terve! Pistä viestiä niin kerron vähän lisää meidän palveluista. 👋"];var i=[{name:"Roni",image:dude.theme_base+"/images/chat-roni.jpg"},{name:"Timi",image:dude.theme_base+"/images/chat-timi.jpg"}];if($crisp.is("website:available")&&!$crisp.is("session:ongoing")&&!$crisp.is("chat:opened")){if("undefined"!=typeof chat_greeting_override)var s=chat_greeting_override;else s=e[Math.floor(Math.random()*e.length)];var n=i[Math.floor(Math.random()*i.length)];t("body").append('<div class="chat-greeting"><button class="open-chat" aria-label="Avaa chat"></button><div class="avatar" style="background-image:url(\''+n.image+'\')"></div><div class="message"><p class="head">Viesti henkilöltä '+n.name+"</p><p>"+s+'</p></div><button class="close-chat close" aria-label="Sulje ilmoitus"><svg viewBox="0 0 36 36" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" width="32" height="32" fill="currentColor"><path class="clr-i-outline clr-i-outline-path-1" d="M19.41 18l8.29-8.29a1 1 0 0 0-1.41-1.41L18 16.59l-8.29-8.3a1 1 0 0 0-1.42 1.42l8.3 8.29-8.3 8.29A1 1 0 1 0 9.7 27.7l8.3-8.29 8.29 8.29a1 1 0 0 0 1.41-1.41z"/></svg></button></div>'),$crisp.push(["on","chat:opened",function(){$crisp.push(["do","message:show",["text",s]]),$crisp.push(["off","chat:opened"])}]),sessionStorage.setItem("chat_greeting_sent",(new Date).toLocaleString())}}}r.registerTrigger(h),"undefined"!=typeof Storage&&(sessionStorage.getItem("chat_greeting_visits")>=3&&null===sessionStorage.getItem("chat_greeting_sent")?setTimeout(function(){c()},1500):null===sessionStorage.getItem("chat_greeting_sent")?(TimeMe.initialize({currentPageName:document.title,idleTimeoutInSeconds:10}),TimeMe.callAfterTimeElapsedInSeconds(5,function(){c()})):i(new Date(sessionStorage.getItem("chat_greeting_sent")))&&(TimeMe.initialize({currentPageName:document.title,idleTimeoutInSeconds:10}),TimeMe.callAfterTimeElapsedInSeconds(5,function(){c()}))),t("body").on("click",".chat-greeting button.close",function(e){t(".chat-greeting").addClass("removed-item").one("webkitAnimationEnd oanimationend msAnimationEnd animationend",function(e){t(".chat-greeting").remove()}),sessionStorage.setItem("chat_greeting_sent",(new Date).toLocaleString())}),t("body").on("click",".open-chat",function(e){e.preventDefault(),t(".chat-greeting").addClass("removed-item").one("webkitAnimationEnd oanimationend msAnimationEnd animationend",function(e){t(".chat-greeting").remove()}),$crisp.push(["do","chat:show"]),$crisp.push(["do","chat:open"])})});var i=function(t){return t<Date.now()-9e5}}(jQuery),window.CRISP_READY_TRIGGER=function(){setTimeout(function(){$crisp.get("chat:unread:count")>0||$crisp.is("session:ongoing")?$crisp.push(["do","chat:show"]):$crisp.push(["do","chat:hide"])},25)};
//# sourceMappingURL=all.js.map
